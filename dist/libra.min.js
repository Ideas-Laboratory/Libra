var ia=Object.defineProperty;var Ll=e=>ia(e,"__esModule",{value:!0});var f=(e,t)=>()=>(e&&(t=e(e=0)),t);var Dl=(e,t)=>{Ll(e);for(var r in t)ia(e,r,{get:t[r],enumerable:!0})};var oa,Qt,at,Hr,ca,O,Yl,kd,Xl,zl,Wt=f(()=>{re();Qt={},at=[],Hr=[],ca=()=>{let e;for(;e=Hr.pop();)try{e.remove()}catch(t){}la.stopTransient||at.filter(t=>t._transient).forEach(t=>t.redraw()),requestAnimationFrame(ca)};requestAnimationFrame(ca);O=class{constructor(t,r){this[oa]=!0,this._baseName=t,this._userOptions=r,this._name=r.name??this._baseName,this._sharedVar=r.sharedVar??{},this._redraw=r.redraw??(()=>{}),this._layer=r.layer,this._transient=r.transient??!1,this.redraw()}getSharedVar(t){return this._sharedVar[t]}setSharedVar(t,r){this._sharedVar[t]=r,this.redraw()}setSharedVars(t){Object.entries(t).forEach(([r,n])=>this._sharedVar[r]=n),this.redraw()}redraw(t=!1){if(!this._layer&&!this.getSharedVar("layer"))return;let r=this._layer||this.getSharedVar("layer");t=t||this._transient;let n=[],a=[],i=new Set([r]);t&&(n=r.getVisualElements(),r._getLayerFromQueue||(r._getLayerFromQueue=r.getLayerFromQueue,r.getLayerFromQueue=function(){let s=r._getLayerFromQueue(...arguments);return n=n.concat(s.getVisualElements()),i.add(s),s})),this._redraw({layer:r,transformer:this}),t&&(r.getLayerFromQueue=r._getLayerFromQueue,delete r._getLayerFromQueue,i.forEach(s=>{a=a.concat(Array.prototype.slice.call(s.getGraphic().childNodes));let o=a.filter(c=>!n.includes(c));Hr=Hr.concat(o)}))}isInstanceOf(t){return this._baseName===t||this._name===t}static register(t,r){Qt[t]=r}static unregister(t){return delete Qt[t],!0}static initialize(t,r){let n=Object.assign({constructor:O},Qt[t]??{},r??{},{sharedVar:Object.assign({},(Qt[t]??{}).sharedVar??{},r?.sharedVar??{})}),a=new n.constructor(t,n);return at.push(a),a}static findTransformer(t){return at.filter(r=>r.isInstanceOf(t))}};oa=W;Yl=O.register,kd=O.unregister,Xl=O.initialize,zl=O.findTransformer});var ua=f(()=>{});var fa=f(()=>{});var ha=f(()=>{});function da(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new $t(r)}function $t(e){this._=e}function Fl(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",a=r.indexOf(".");if(a>=0&&(n=r.slice(a+1),r=r.slice(0,a)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}function Ul(e,t){for(var r=0,n=e.length,a;r<n;++r)if((a=e[r]).name===t)return a.value}function pa(e,t,r){for(var n=0,a=e.length;n<a;++n)if(e[n].name===t){e[n]=Pl,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var Pl,Qr,ma=f(()=>{Pl={value:()=>{}};$t.prototype=da.prototype={constructor:$t,on:function(e,t){var r=this._,n=Fl(e+"",r),a,i=-1,s=n.length;if(arguments.length<2){for(;++i<s;)if((a=(e=n[i]).type)&&(a=Ul(r[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(a=(e=n[i]).type)r[a]=pa(r[a],e.name,t);else if(t==null)for(a in r)r[a]=pa(r[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new $t(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var r=new Array(a),n=0,a,i;n<a;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],n=0,a=i.length;n<a;++n)i[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],a=0,i=n.length;a<i;++a)n[a].value.apply(t,r)}};Qr=da});var Wr=f(()=>{ma()});var Zt,$r,Zr=f(()=>{Zt="http://www.w3.org/1999/xhtml",$r={svg:"http://www.w3.org/2000/svg",xhtml:Zt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"}});function de(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),$r.hasOwnProperty(t)?{space:$r[t],local:e}:e}var Kt=f(()=>{Zr()});function Nl(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===Zt&&t.documentElement.namespaceURI===Zt?t.createElement(e):t.createElementNS(r,e)}}function ql(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Jt(e){var t=de(e);return(t.local?ql:Nl)(t)}var Kr=f(()=>{Kt();Zr()});function Gl(){}function Me(e){return e==null?Gl:function(){return this.querySelector(e)}}var er=f(()=>{});function ga(e){typeof e!="function"&&(e=Me(e));for(var t=this._groups,r=t.length,n=new Array(r),a=0;a<r;++a)for(var i=t[a],s=i.length,o=n[a]=new Array(s),c,l,u=0;u<s;++u)(c=i[u])&&(l=e.call(c,c.__data__,u,i))&&("__data__"in c&&(l.__data__=c.__data__),o[u]=l);return new R(n,this._parents)}var xa=f(()=>{ne();er()});function He(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}var tr=f(()=>{});function Bl(){return[]}function st(e){return e==null?Bl:function(){return this.querySelectorAll(e)}}var Jr=f(()=>{});function Hl(e){return function(){var t=e.apply(this,arguments);return t==null?[]:He(t)}}function ya(e){typeof e=="function"?e=Hl(e):e=st(e);for(var t=this._groups,r=t.length,n=[],a=[],i=0;i<r;++i)for(var s=t[i],o=s.length,c,l=0;l<o;++l)(c=s[l])&&(n.push(e.call(c,c.__data__,l,s)),a.push(c));return new R(n,a)}var _a=f(()=>{ne();tr();Jr()});function it(e){return function(){return this.matches(e)}}function rr(e){return function(t){return t.matches(e)}}var ot=f(()=>{});function Wl(e){return function(){return Ql.call(this.children,e)}}function $l(){return this.firstElementChild}function va(e){return this.select(e==null?$l:Wl(typeof e=="function"?e:rr(e)))}var Ql,wa=f(()=>{ot();Ql=Array.prototype.find});function Kl(){return this.children}function Jl(e){return function(){return Zl.call(this.children,e)}}function Sa(e){return this.selectAll(e==null?Kl:Jl(typeof e=="function"?e:rr(e)))}var Zl,ba=f(()=>{ot();Zl=Array.prototype.filter});function ja(e){typeof e!="function"&&(e=it(e));for(var t=this._groups,r=t.length,n=new Array(r),a=0;a<r;++a)for(var i=t[a],s=i.length,o=n[a]=[],c,l=0;l<s;++l)(c=i[l])&&e.call(c,c.__data__,l,i)&&o.push(c);return new R(n,this._parents)}var Va=f(()=>{ne();ot()});function nr(e){return new Array(e.length)}var en=f(()=>{});function Ta(){return new R(this._enter||this._groups.map(nr),this._parents)}function ct(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}var tn=f(()=>{en();ne();ct.prototype={constructor:ct,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}}});function Ea(e){return function(){return e}}var Ca=f(()=>{});function eu(e,t,r,n,a,i){for(var s=0,o,c=t.length,l=i.length;s<l;++s)(o=t[s])?(o.__data__=i[s],n[s]=o):r[s]=new ct(e,i[s]);for(;s<c;++s)(o=t[s])&&(a[s]=o)}function tu(e,t,r,n,a,i,s){var o,c,l=new Map,u=t.length,h=i.length,p=new Array(u),d;for(o=0;o<u;++o)(c=t[o])&&(p[o]=d=s.call(c,c.__data__,o,t)+"",l.has(d)?a[o]=c:l.set(d,c));for(o=0;o<h;++o)d=s.call(e,i[o],o,i)+"",(c=l.get(d))?(n[o]=c,c.__data__=i[o],l.delete(d)):r[o]=new ct(e,i[o]);for(o=0;o<u;++o)(c=t[o])&&l.get(p[o])===c&&(a[o]=c)}function ru(e){return e.__data__}function Ia(e,t){if(!arguments.length)return Array.from(this,ru);var r=t?tu:eu,n=this._parents,a=this._groups;typeof e!="function"&&(e=Ea(e));for(var i=a.length,s=new Array(i),o=new Array(i),c=new Array(i),l=0;l<i;++l){var u=n[l],h=a[l],p=h.length,d=He(e.call(u,u&&u.__data__,l,n)),x=d.length,g=o[l]=new Array(x),_=s[l]=new Array(x),v=c[l]=new Array(p);r(u,h,g,_,v,d,t);for(var E=0,w=0,M,k;E<x;++E)if(M=g[E]){for(E>=w&&(w=E+1);!(k=_[w])&&++w<x;);M._next=k||null}}return s=new R(s,n),s._enter=o,s._exit=c,s}var Ma=f(()=>{ne();tn();tr();Ca()});function Aa(){return new R(this._exit||this._groups.map(nr),this._parents)}var Ra=f(()=>{en();ne()});function ka(e,t,r){var n=this.enter(),a=this,i=this.exit();return n=typeof e=="function"?e(n):n.append(e+""),t!=null&&(a=t(a)),r==null?i.remove():r(i),n&&a?n.merge(a).order():a}var Oa=f(()=>{});function La(e){if(!(e instanceof R))throw new Error("invalid merge");for(var t=this._groups,r=e._groups,n=t.length,a=r.length,i=Math.min(n,a),s=new Array(n),o=0;o<i;++o)for(var c=t[o],l=r[o],u=c.length,h=s[o]=new Array(u),p,d=0;d<u;++d)(p=c[d]||l[d])&&(h[d]=p);for(;o<n;++o)s[o]=t[o];return new R(s,this._parents)}var Da=f(()=>{ne()});function Ya(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],a=n.length-1,i=n[a],s;--a>=0;)(s=n[a])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}var Xa=f(()=>{});function za(e){e||(e=nu);function t(h,p){return h&&p?e(h.__data__,p.__data__):!h-!p}for(var r=this._groups,n=r.length,a=new Array(n),i=0;i<n;++i){for(var s=r[i],o=s.length,c=a[i]=new Array(o),l,u=0;u<o;++u)(l=s[u])&&(c[u]=l);c.sort(t)}return new R(a,this._parents).order()}function nu(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}var Pa=f(()=>{ne()});function Fa(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}var Ua=f(()=>{});function Na(){return Array.from(this)}var qa=f(()=>{});function Ga(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],a=0,i=n.length;a<i;++a){var s=n[a];if(s)return s}return null}var Ba=f(()=>{});function Ha(){let e=0;for(let t of this)++e;return e}var Qa=f(()=>{});function Wa(){return!this.node()}var $a=f(()=>{});function Za(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var a=t[r],i=0,s=a.length,o;i<s;++i)(o=a[i])&&e.call(o,o.__data__,i,a);return this}var Ka=f(()=>{});function au(e){return function(){this.removeAttribute(e)}}function su(e){return function(){this.removeAttributeNS(e.space,e.local)}}function iu(e,t){return function(){this.setAttribute(e,t)}}function ou(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function cu(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function lu(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function Ja(e,t){var r=de(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?su:au:typeof t=="function"?r.local?lu:cu:r.local?ou:iu)(r,t))}var es=f(()=>{Kt()});function ar(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}var rn=f(()=>{});function uu(e){return function(){this.style.removeProperty(e)}}function fu(e,t,r){return function(){this.style.setProperty(e,t,r)}}function hu(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function ts(e,t,r){return arguments.length>1?this.each((t==null?uu:typeof t=="function"?hu:fu)(e,t,r??"")):ve(this.node(),e)}function ve(e,t){return e.style.getPropertyValue(t)||ar(e).getComputedStyle(e,null).getPropertyValue(t)}var nn=f(()=>{rn()});function du(e){return function(){delete this[e]}}function pu(e,t){return function(){this[e]=t}}function mu(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function rs(e,t){return arguments.length>1?this.each((t==null?du:typeof t=="function"?mu:pu)(e,t)):this.node()[e]}var ns=f(()=>{});function as(e){return e.trim().split(/^|\s+/)}function an(e){return e.classList||new ss(e)}function ss(e){this._node=e,this._names=as(e.getAttribute("class")||"")}function is(e,t){for(var r=an(e),n=-1,a=t.length;++n<a;)r.add(t[n])}function os(e,t){for(var r=an(e),n=-1,a=t.length;++n<a;)r.remove(t[n])}function gu(e){return function(){is(this,e)}}function xu(e){return function(){os(this,e)}}function yu(e,t){return function(){(t.apply(this,arguments)?is:os)(this,e)}}function cs(e,t){var r=as(e+"");if(arguments.length<2){for(var n=an(this.node()),a=-1,i=r.length;++a<i;)if(!n.contains(r[a]))return!1;return!0}return this.each((typeof t=="function"?yu:t?gu:xu)(r,t))}var ls=f(()=>{ss.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}}});function _u(){this.textContent=""}function vu(e){return function(){this.textContent=e}}function wu(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function us(e){return arguments.length?this.each(e==null?_u:(typeof e=="function"?wu:vu)(e)):this.node().textContent}var fs=f(()=>{});function Su(){this.innerHTML=""}function bu(e){return function(){this.innerHTML=e}}function ju(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function hs(e){return arguments.length?this.each(e==null?Su:(typeof e=="function"?ju:bu)(e)):this.node().innerHTML}var ds=f(()=>{});function Vu(){this.nextSibling&&this.parentNode.appendChild(this)}function ps(){return this.each(Vu)}var ms=f(()=>{});function Tu(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function gs(){return this.each(Tu)}var xs=f(()=>{});function ys(e){var t=typeof e=="function"?e:Jt(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}var _s=f(()=>{Kr()});function Eu(){return null}function vs(e,t){var r=typeof e=="function"?e:Jt(e),n=t==null?Eu:typeof t=="function"?t:Me(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}var ws=f(()=>{Kr();er()});function Cu(){var e=this.parentNode;e&&e.removeChild(this)}function Ss(){return this.each(Cu)}var bs=f(()=>{});function Iu(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Mu(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function js(e){return this.select(e?Mu:Iu)}var Vs=f(()=>{});function Ts(e){return arguments.length?this.property("__data__",e):this.node().__data__}var Es=f(()=>{});function Au(e){return function(t){e.call(this,t,this.__data__)}}function Ru(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function ku(e){return function(){var t=this.__on;if(!!t){for(var r=0,n=-1,a=t.length,i;r<a;++r)i=t[r],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++n]=i;++n?t.length=n:delete this.__on}}}function Ou(e,t,r){return function(){var n=this.__on,a,i=Au(t);if(n){for(var s=0,o=n.length;s<o;++s)if((a=n[s]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=i,a.options=r),a.value=t;return}}this.addEventListener(e.type,i,r),a={type:e.type,name:e.name,value:t,listener:i,options:r},n?n.push(a):this.__on=[a]}}function Cs(e,t,r){var n=Ru(e+""),a,i=n.length,s;if(arguments.length<2){var o=this.node().__on;if(o){for(var c=0,l=o.length,u;c<l;++c)for(a=0,u=o[c];a<i;++a)if((s=n[a]).type===u.type&&s.name===u.name)return u.value}return}for(o=t?Ou:ku,a=0;a<i;++a)this.each(o(n[a],t,r));return this}var Is=f(()=>{});function Ms(e,t,r){var n=ar(e),a=n.CustomEvent;typeof a=="function"?a=new a(t,r):(a=n.document.createEvent("Event"),r?(a.initEvent(t,r.bubbles,r.cancelable),a.detail=r.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function Lu(e,t){return function(){return Ms(this,e,t)}}function Du(e,t){return function(){return Ms(this,e,t.apply(this,arguments))}}function As(e,t){return this.each((typeof t=="function"?Du:Lu)(e,t))}var Rs=f(()=>{rn()});function*ks(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],a=0,i=n.length,s;a<i;++a)(s=n[a])&&(yield s)}var Os=f(()=>{});function R(e,t){this._groups=e,this._parents=t}function Ls(){return new R([[document.documentElement]],lt)}function Yu(){return this}var lt,pe,ne=f(()=>{xa();_a();wa();ba();Va();Ma();tn();Ra();Oa();Da();Xa();Pa();Ua();qa();Ba();Qa();$a();Ka();es();nn();ns();ls();fs();ds();ms();xs();_s();ws();bs();Vs();Es();Is();Rs();Os();lt=[null];R.prototype=Ls.prototype={constructor:R,select:ga,selectAll:ya,selectChild:va,selectChildren:Sa,filter:ja,data:Ia,enter:Ta,exit:Aa,join:ka,merge:La,selection:Yu,order:Ya,sort:za,call:Fa,nodes:Na,node:Ga,size:Ha,empty:Wa,each:Za,attr:Ja,style:ts,property:rs,classed:cs,text:us,html:hs,raise:ps,lower:gs,append:ys,insert:vs,remove:Ss,clone:js,datum:Ts,on:Cs,dispatch:As,[Symbol.iterator]:ks};pe=Ls});function L(e){return typeof e=="string"?new R([[document.querySelector(e)]],[document.documentElement]):new R([[e]],lt)}var Ds=f(()=>{ne()});function Ys(e){let t;for(;t=e.sourceEvent;)e=t;return e}var Xs=f(()=>{});function we(e,t){if(e=Ys(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]}var zs=f(()=>{Xs()});function ut(e){return typeof e=="string"?new R([document.querySelectorAll(e)],[document.documentElement]):new R([e==null?[]:He(e)],lt)}var Ps=f(()=>{tr();ne()});var ie=f(()=>{ot();Kt();zs();Ds();Ps();ne();er();Jr();nn()});var Fs=f(()=>{});function sr(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function sn(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}var Us=f(()=>{});function ft(){}function qs(){return this.rgb().formatHex()}function Gu(){return $s(this).formatHsl()}function Gs(){return this.rgb().formatRgb()}function Se(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=Xu.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Bs(t):r===3?new te(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?or(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?or(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=zu.exec(e))?new te(t[1],t[2],t[3],1):(t=Pu.exec(e))?new te(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Fu.exec(e))?or(t[1],t[2],t[3],t[4]):(t=Uu.exec(e))?or(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Nu.exec(e))?Ws(t[1],t[2]/100,t[3]/100,1):(t=qu.exec(e))?Ws(t[1],t[2]/100,t[3]/100,t[4]):Ns.hasOwnProperty(e)?Bs(Ns[e]):e==="transparent"?new te(NaN,NaN,NaN,0):null}function Bs(e){return new te(e>>16&255,e>>8&255,e&255,1)}function or(e,t,r,n){return n<=0&&(e=t=r=NaN),new te(e,t,r,n)}function Bu(e){return e instanceof ft||(e=Se(e)),e?(e=e.rgb(),new te(e.r,e.g,e.b,e.opacity)):new te}function We(e,t,r,n){return arguments.length===1?Bu(e):new te(e,t,r,n??1)}function te(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}function Hs(){return"#"+on(this.r)+on(this.g)+on(this.b)}function Qs(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function on(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function Ws(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ue(e,t,r,n)}function $s(e){if(e instanceof ue)return new ue(e.h,e.s,e.l,e.opacity);if(e instanceof ft||(e=Se(e)),!e)return new ue;if(e instanceof ue)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,o=i-a,c=(i+a)/2;return o?(t===i?s=(r-n)/o+(r<n)*6:r===i?s=(n-t)/o+2:s=(t-r)/o+4,o/=c<.5?i+a:2-i-a,s*=60):o=c>0&&c<1?0:s,new ue(s,o,c,e.opacity)}function Zs(e,t,r,n){return arguments.length===1?$s(e):new ue(e,t,r,n??1)}function ue(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function cn(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}var ht,ir,Qe,dt,le,Xu,zu,Pu,Fu,Uu,Nu,qu,Ns,Ks=f(()=>{Us();ht=.7,ir=1/ht,Qe="\\s*([+-]?\\d+)\\s*",dt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",le="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Xu=/^#([0-9a-f]{3,8})$/,zu=new RegExp("^rgb\\("+[Qe,Qe,Qe]+"\\)$"),Pu=new RegExp("^rgb\\("+[le,le,le]+"\\)$"),Fu=new RegExp("^rgba\\("+[Qe,Qe,Qe,dt]+"\\)$"),Uu=new RegExp("^rgba\\("+[le,le,le,dt]+"\\)$"),Nu=new RegExp("^hsl\\("+[dt,le,le]+"\\)$"),qu=new RegExp("^hsla\\("+[dt,le,le,dt]+"\\)$"),Ns={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};sr(ft,Se,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:qs,formatHex:qs,formatHsl:Gu,formatRgb:Gs,toString:Gs});sr(te,We,sn(ft,{brighter:function(e){return e=e==null?ir:Math.pow(ir,e),new te(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?ht:Math.pow(ht,e),new te(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Hs,formatHex:Hs,formatRgb:Qs,toString:Qs}));sr(ue,Zs,sn(ft,{brighter:function(e){return e=e==null?ir:Math.pow(ir,e),new ue(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?ht:Math.pow(ht,e),new ue(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new te(cn(e>=240?e-240:e+120,a,n),cn(e,a,n),cn(e<120?e+240:e-120,a,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}))});var cr=f(()=>{Ks()});function ln(e,t,r,n,a){var i=e*e,s=i*e;return((1-3*e+3*i-s)*t+(4-6*i+3*s)*r+(1+3*e+3*i-3*s)*n+s*a)/6}function Js(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),a=e[n],i=e[n+1],s=n>0?e[n-1]:2*a-i,o=n<t-1?e[n+2]:2*i-a;return ln((r-n/t)*t,s,a,i,o)}}var un=f(()=>{});function ei(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*t),a=e[(n+t-1)%t],i=e[n%t],s=e[(n+1)%t],o=e[(n+2)%t];return ln((r-n/t)*t,a,i,s,o)}}var ti=f(()=>{un()});var fn,ri=f(()=>{fn=e=>()=>e});function Hu(e,t){return function(r){return e+r*t}}function Qu(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function ni(e){return(e=+e)==1?lr:function(t,r){return r-t?Qu(t,r,e):fn(isNaN(t)?r:t)}}function lr(e,t){var r=t-e;return r?Hu(e,r):fn(isNaN(e)?t:e)}var ai=f(()=>{ri()});function si(e){return function(t){var r=t.length,n=new Array(r),a=new Array(r),i=new Array(r),s,o;for(s=0;s<r;++s)o=We(t[s]),n[s]=o.r||0,a[s]=o.g||0,i[s]=o.b||0;return n=e(n),a=e(a),i=e(i),o.opacity=1,function(c){return o.r=n(c),o.g=a(c),o.b=i(c),o+""}}}var ur,Wu,$u,ii=f(()=>{cr();un();ti();ai();ur=function e(t){var r=ni(t);function n(a,i){var s=r((a=We(a)).r,(i=We(i)).r),o=r(a.g,i.g),c=r(a.b,i.b),l=lr(a.opacity,i.opacity);return function(u){return a.r=s(u),a.g=o(u),a.b=c(u),a.opacity=l(u),a+""}}return n.gamma=e,n}(1);Wu=si(Js),$u=si(ei)});function ae(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var fr=f(()=>{});function Zu(e){return function(){return e}}function Ku(e){return function(t){return e(t)+""}}function pn(e,t){var r=hn.lastIndex=dn.lastIndex=0,n,a,i,s=-1,o=[],c=[];for(e=e+"",t=t+"";(n=hn.exec(e))&&(a=dn.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,c.push({i:s,x:ae(n,a)})),r=dn.lastIndex;return r<t.length&&(i=t.slice(r),o[s]?o[s]+=i:o[++s]=i),o.length<2?c[0]?Ku(c[0].x):Zu(t):(t=c.length,function(l){for(var u=0,h;u<t;++u)o[(h=c[u]).i]=h.x(l);return o.join("")})}var hn,dn,oi=f(()=>{fr();hn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,dn=new RegExp(hn.source,"g")});function mn(e,t,r,n,a,i){var s,o,c;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(c=e*r+t*n)&&(r-=e*c,n-=t*c),(o=Math.sqrt(r*r+n*n))&&(r/=o,n/=o,c/=o),e*n<t*r&&(e=-e,t=-t,c=-c,s=-s),{translateX:a,translateY:i,rotate:Math.atan2(t,e)*ci,skewX:Math.atan(c)*ci,scaleX:s,scaleY:o}}var ci,hr,li=f(()=>{ci=180/Math.PI,hr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1}});function ui(e){let t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?hr:mn(t.a,t.b,t.c,t.d,t.e,t.f)}function fi(e){return e==null?hr:(dr||(dr=document.createElementNS("http://www.w3.org/2000/svg","g")),dr.setAttribute("transform",e),(e=dr.transform.baseVal.consolidate())?(e=e.matrix,mn(e.a,e.b,e.c,e.d,e.e,e.f)):hr)}var dr,hi=f(()=>{li()});function di(e,t,r,n){function a(l){return l.length?l.pop()+" ":""}function i(l,u,h,p,d,x){if(l!==h||u!==p){var g=d.push("translate(",null,t,null,r);x.push({i:g-4,x:ae(l,h)},{i:g-2,x:ae(u,p)})}else(h||p)&&d.push("translate("+h+t+p+r)}function s(l,u,h,p){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),p.push({i:h.push(a(h)+"rotate(",null,n)-2,x:ae(l,u)})):u&&h.push(a(h)+"rotate("+u+n)}function o(l,u,h,p){l!==u?p.push({i:h.push(a(h)+"skewX(",null,n)-2,x:ae(l,u)}):u&&h.push(a(h)+"skewX("+u+n)}function c(l,u,h,p,d,x){if(l!==h||u!==p){var g=d.push(a(d)+"scale(",null,",",null,")");x.push({i:g-4,x:ae(l,h)},{i:g-2,x:ae(u,p)})}else(h!==1||p!==1)&&d.push(a(d)+"scale("+h+","+p+")")}return function(l,u){var h=[],p=[];return l=e(l),u=e(u),i(l.translateX,l.translateY,u.translateX,u.translateY,h,p),s(l.rotate,u.rotate,h,p),o(l.skewX,u.skewX,h,p),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,h,p),l=u=null,function(d){for(var x=-1,g=p.length,_;++x<g;)h[(_=p[x]).i]=_.x(d);return h.join("")}}}var gn,xn,pi=f(()=>{fr();hi();gn=di(ui,"px, ","px)","deg)"),xn=di(fi,", ",")",")")});var pt=f(()=>{fr();oi();pi();ii()});function _t(){return Ae||(gi(Ju),Ae=yt.now()+gr)}function Ju(){Ae=0}function vt(){this._call=this._time=this._next=null}function xr(e,t,r){var n=new vt;return n.restart(e,t,r),n}function xi(){_t(),++$e;for(var e=pr,t;e;)(t=Ae-e._time)>=0&&e._call.call(null,t),e=e._next;--$e}function yi(){Ae=(mr=yt.now())+gr,$e=mt=0;try{xi()}finally{$e=0,tf(),Ae=0}}function ef(){var e=yt.now(),t=e-mr;t>mi&&(gr-=t,mr=e)}function tf(){for(var e,t=pr,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:pr=r);xt=e,yn(n)}function yn(e){if(!$e){mt&&(mt=clearTimeout(mt));var t=e-Ae;t>24?(e<1/0&&(mt=setTimeout(yi,e-yt.now()-gr)),gt&&(gt=clearInterval(gt))):(gt||(mr=yt.now(),gt=setInterval(ef,mi)),$e=1,gi(yi))}}var $e,mt,gt,mi,pr,xt,mr,Ae,gr,yt,gi,_n=f(()=>{$e=0,mt=0,gt=0,mi=1e3,mr=0,Ae=0,gr=0,yt=typeof performance=="object"&&performance.now?performance:Date,gi=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};vt.prototype=xr.prototype={constructor:vt,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?_t():+r)+(t==null?0:+t),!this._next&&xt!==this&&(xt?xt._next=this:pr=this,xt=this),this._call=e,this._time=r,yn()},stop:function(){this._call&&(this._call=null,this._time=1/0,yn())}}});function yr(e,t,r){var n=new vt;return t=t==null?0:+t,n.restart(a=>{n.stop(),e(a+t)},t,r),n}var _i=f(()=>{_n()});var _r=f(()=>{_n();_i()});function be(e,t,r,n,a,i){var s=e.__transition;if(!s)e.__transition={};else if(r in s)return;af(e,r,{name:t,index:n,group:a,on:rf,tween:nf,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:vi})}function St(e,t){var r=X(e,t);if(r.state>vi)throw new Error("too late; already scheduled");return r}function F(e,t){var r=X(e,t);if(r.state>wr)throw new Error("too late; already running");return r}function X(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function af(e,t,r){var n=e.__transition,a;n[t]=r,r.timer=xr(i,0,r.time);function i(l){r.state=vn,r.timer.restart(s,r.delay,r.time),r.delay<=l&&s(l-r.delay)}function s(l){var u,h,p,d;if(r.state!==vn)return c();for(u in n)if(d=n[u],d.name===r.name){if(d.state===wr)return yr(s);d.state===wi?(d.state=wt,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete n[u]):+u<t&&(d.state=wt,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete n[u])}if(yr(function(){r.state===wr&&(r.state=wi,r.timer.restart(o,r.delay,r.time),o(l))}),r.state=vr,r.on.call("start",e,e.__data__,r.index,r.group),r.state===vr){for(r.state=wr,a=new Array(p=r.tween.length),u=0,h=-1;u<p;++u)(d=r.tween[u].value.call(e,e.__data__,r.index,r.group))&&(a[++h]=d);a.length=h+1}}function o(l){for(var u=l<r.duration?r.ease.call(null,l/r.duration):(r.timer.restart(c),r.state=Sr,1),h=-1,p=a.length;++h<p;)a[h].call(e,u);r.state===Sr&&(r.on.call("end",e,e.__data__,r.index,r.group),c())}function c(){r.state=wt,r.timer.stop(),delete n[t];for(var l in n)return;delete e.__transition}}var rf,nf,vi,vn,vr,wr,wi,Sr,wt,B=f(()=>{Wr();_r();rf=Qr("start","end","cancel","interrupt"),nf=[],vi=0,vn=1,vr=2,wr=3,wi=4,Sr=5,wt=6});function bt(e,t){var r=e.__transition,n,a,i=!0,s;if(!!r){t=t==null?null:t+"";for(s in r){if((n=r[s]).name!==t){i=!1;continue}a=n.state>vr&&n.state<Sr,n.state=wt,n.timer.stop(),n.on.call(a?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[s]}i&&delete e.__transition}}var wn=f(()=>{B()});function Si(e){return this.each(function(){bt(this,e)})}var bi=f(()=>{wn()});function sf(e,t){var r,n;return function(){var a=F(this,e),i=a.tween;if(i!==r){n=r=i;for(var s=0,o=n.length;s<o;++s)if(n[s].name===t){n=n.slice(),n.splice(s,1);break}}a.tween=n}}function of(e,t,r){var n,a;if(typeof r!="function")throw new Error;return function(){var i=F(this,e),s=i.tween;if(s!==n){a=(n=s).slice();for(var o={name:t,value:r},c=0,l=a.length;c<l;++c)if(a[c].name===t){a[c]=o;break}c===l&&a.push(o)}i.tween=a}}function ji(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=X(this.node(),r).tween,a=0,i=n.length,s;a<i;++a)if((s=n[a]).name===e)return s.value;return null}return this.each((t==null?sf:of)(r,e,t))}function Ze(e,t,r){var n=e._id;return e.each(function(){var a=F(this,n);(a.value||(a.value={}))[t]=r.apply(this,arguments)}),function(a){return X(a,n).value[t]}}var jt=f(()=>{B()});function br(e,t){var r;return(typeof t=="number"?ae:t instanceof Se?ur:(r=Se(t))?(t=r,ur):pn)(e,t)}var Sn=f(()=>{cr();pt()});function cf(e){return function(){this.removeAttribute(e)}}function lf(e){return function(){this.removeAttributeNS(e.space,e.local)}}function uf(e,t,r){var n,a=r+"",i;return function(){var s=this.getAttribute(e);return s===a?null:s===n?i:i=t(n=s,r)}}function ff(e,t,r){var n,a=r+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===a?null:s===n?i:i=t(n=s,r)}}function hf(e,t,r){var n,a,i;return function(){var s,o=r(this),c;return o==null?void this.removeAttribute(e):(s=this.getAttribute(e),c=o+"",s===c?null:s===n&&c===a?i:(a=c,i=t(n=s,o)))}}function df(e,t,r){var n,a,i;return function(){var s,o=r(this),c;return o==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),c=o+"",s===c?null:s===n&&c===a?i:(a=c,i=t(n=s,o)))}}function Vi(e,t){var r=de(e),n=r==="transform"?xn:br;return this.attrTween(e,typeof t=="function"?(r.local?df:hf)(r,n,Ze(this,"attr."+e,t)):t==null?(r.local?lf:cf)(r):(r.local?ff:uf)(r,n,t))}var Ti=f(()=>{pt();ie();jt();Sn()});function pf(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function mf(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function gf(e,t){var r,n;function a(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&mf(e,i)),r}return a._value=t,a}function xf(e,t){var r,n;function a(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&pf(e,i)),r}return a._value=t,a}function Ei(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=de(e);return this.tween(r,(n.local?gf:xf)(n,t))}var Ci=f(()=>{ie()});function yf(e,t){return function(){St(this,e).delay=+t.apply(this,arguments)}}function _f(e,t){return t=+t,function(){St(this,e).delay=t}}function Ii(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?yf:_f)(t,e)):X(this.node(),t).delay}var Mi=f(()=>{B()});function vf(e,t){return function(){F(this,e).duration=+t.apply(this,arguments)}}function wf(e,t){return t=+t,function(){F(this,e).duration=t}}function Ai(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?vf:wf)(t,e)):X(this.node(),t).duration}var Ri=f(()=>{B()});function Sf(e,t){if(typeof t!="function")throw new Error;return function(){F(this,e).ease=t}}function ki(e){var t=this._id;return arguments.length?this.each(Sf(t,e)):X(this.node(),t).ease}var Oi=f(()=>{B()});function bf(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;F(this,e).ease=r}}function Li(e){if(typeof e!="function")throw new Error;return this.each(bf(this._id,e))}var Di=f(()=>{B()});function Yi(e){typeof e!="function"&&(e=it(e));for(var t=this._groups,r=t.length,n=new Array(r),a=0;a<r;++a)for(var i=t[a],s=i.length,o=n[a]=[],c,l=0;l<s;++l)(c=i[l])&&e.call(c,c.__data__,l,i)&&o.push(c);return new N(n,this._parents,this._name,this._id)}var Xi=f(()=>{ie();me()});function zi(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,a=r.length,i=Math.min(n,a),s=new Array(n),o=0;o<i;++o)for(var c=t[o],l=r[o],u=c.length,h=s[o]=new Array(u),p,d=0;d<u;++d)(p=c[d]||l[d])&&(h[d]=p);for(;o<n;++o)s[o]=t[o];return new N(s,this._parents,this._name,this._id)}var Pi=f(()=>{me()});function jf(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function Vf(e,t,r){var n,a,i=jf(t)?St:F;return function(){var s=i(this,e),o=s.on;o!==n&&(a=(n=o).copy()).on(t,r),s.on=a}}function Fi(e,t){var r=this._id;return arguments.length<2?X(this.node(),r).on.on(e):this.each(Vf(r,e,t))}var Ui=f(()=>{B()});function Tf(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function Ni(){return this.on("end.remove",Tf(this._id))}var qi=f(()=>{});function Gi(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Me(e));for(var n=this._groups,a=n.length,i=new Array(a),s=0;s<a;++s)for(var o=n[s],c=o.length,l=i[s]=new Array(c),u,h,p=0;p<c;++p)(u=o[p])&&(h=e.call(u,u.__data__,p,o))&&("__data__"in u&&(h.__data__=u.__data__),l[p]=h,be(l[p],t,r,p,l,X(u,r)));return new N(i,this._parents,t,r)}var Bi=f(()=>{ie();me();B()});function Hi(e){var t=this._name,r=this._id;typeof e!="function"&&(e=st(e));for(var n=this._groups,a=n.length,i=[],s=[],o=0;o<a;++o)for(var c=n[o],l=c.length,u,h=0;h<l;++h)if(u=c[h]){for(var p=e.call(u,u.__data__,h,c),d,x=X(u,r),g=0,_=p.length;g<_;++g)(d=p[g])&&be(d,t,r,g,p,x);i.push(p),s.push(u)}return new N(i,s,t,r)}var Qi=f(()=>{ie();me();B()});function Wi(){return new Ef(this._groups,this._parents)}var Ef,$i=f(()=>{ie();Ef=pe.prototype.constructor});function Cf(e,t){var r,n,a;return function(){var i=ve(this,e),s=(this.style.removeProperty(e),ve(this,e));return i===s?null:i===r&&s===n?a:a=t(r=i,n=s)}}function Zi(e){return function(){this.style.removeProperty(e)}}function If(e,t,r){var n,a=r+"",i;return function(){var s=ve(this,e);return s===a?null:s===n?i:i=t(n=s,r)}}function Mf(e,t,r){var n,a,i;return function(){var s=ve(this,e),o=r(this),c=o+"";return o==null&&(c=o=(this.style.removeProperty(e),ve(this,e))),s===c?null:s===n&&c===a?i:(a=c,i=t(n=s,o))}}function Af(e,t){var r,n,a,i="style."+t,s="end."+i,o;return function(){var c=F(this,e),l=c.on,u=c.value[i]==null?o||(o=Zi(t)):void 0;(l!==r||a!==u)&&(n=(r=l).copy()).on(s,a=u),c.on=n}}function Ki(e,t,r){var n=(e+="")==="transform"?gn:br;return t==null?this.styleTween(e,Cf(e,n)).on("end.style."+e,Zi(e)):typeof t=="function"?this.styleTween(e,Mf(e,n,Ze(this,"style."+e,t))).each(Af(this._id,e)):this.styleTween(e,If(e,n,t),r).on("end.style."+e,null)}var Ji=f(()=>{pt();ie();B();jt();Sn()});function Rf(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function kf(e,t,r){var n,a;function i(){var s=t.apply(this,arguments);return s!==a&&(n=(a=s)&&Rf(e,s,r)),n}return i._value=t,i}function eo(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,kf(e,t,r??""))}var to=f(()=>{});function Of(e){return function(){this.textContent=e}}function Lf(e){return function(){var t=e(this);this.textContent=t??""}}function ro(e){return this.tween("text",typeof e=="function"?Lf(Ze(this,"text",e)):Of(e==null?"":e+""))}var no=f(()=>{jt()});function Df(e){return function(t){this.textContent=e.call(this,t)}}function Yf(e){var t,r;function n(){var a=e.apply(this,arguments);return a!==r&&(t=(r=a)&&Df(a)),t}return n._value=e,n}function ao(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Yf(e))}var so=f(()=>{});function io(){for(var e=this._name,t=this._id,r=jr(),n=this._groups,a=n.length,i=0;i<a;++i)for(var s=n[i],o=s.length,c,l=0;l<o;++l)if(c=s[l]){var u=X(c,t);be(c,e,r,l,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new N(n,this._parents,e,r)}var oo=f(()=>{me();B()});function co(){var e,t,r=this,n=r._id,a=r.size();return new Promise(function(i,s){var o={value:s},c={value:function(){--a==0&&i()}};r.each(function(){var l=F(this,n),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(o),t._.interrupt.push(o),t._.end.push(c)),l.on=t}),a===0&&i()})}var lo=f(()=>{B()});function N(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function bn(e){return pe().transition(e)}function jr(){return++Xf}var Xf,Re,me=f(()=>{ie();Ti();Ci();Mi();Ri();Oi();Di();Xi();Pi();Ui();qi();Bi();Qi();$i();Ji();to();no();so();oo();jt();lo();Xf=0;Re=pe.prototype;N.prototype=bn.prototype={constructor:N,select:Gi,selectAll:Hi,filter:Yi,merge:zi,selection:Wi,transition:io,call:Re.call,nodes:Re.nodes,node:Re.node,size:Re.size,empty:Re.empty,each:Re.each,on:Fi,attr:Vi,attrTween:Ei,style:Ki,styleTween:eo,text:ro,textTween:ao,remove:Ni,tween:ji,delay:Ii,duration:Ai,ease:ki,easeVarying:Li,end:co,[Symbol.iterator]:Re[Symbol.iterator]}});function Vr(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var uo=f(()=>{});var jn=f(()=>{uo()});function Pf(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function fo(e){var t,r;e instanceof N?(t=e._id,e=e._name):(t=jr(),(r=zf).time=_t(),e=e==null?null:e+"");for(var n=this._groups,a=n.length,i=0;i<a;++i)for(var s=n[i],o=s.length,c,l=0;l<o;++l)(c=s[l])&&be(c,e,t,l,s,r||Pf(c,t));return new N(n,this._parents,e,t)}var zf,ho=f(()=>{me();B();jn();_r();zf={time:null,delay:0,duration:250,ease:Vr}});var po=f(()=>{ie();bi();ho();pe.prototype.interrupt=Si;pe.prototype.transition=fo});var mo=f(()=>{me();B()});var Tr=f(()=>{po();me();mo();wn()});var go=f(()=>{});var xo=f(()=>{});var yo=f(()=>{});function _o(e){return[+e[0],+e[1]]}function Ff(e){return[_o(e[0]),_o(e[1])]}function Vn(e){return{type:e}}var Wy,$y,Zy,vo=f(()=>{Tr();go();xo();yo();Wy={name:"x",handles:["w","e"].map(Vn),input:function(e,t){return e==null?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},$y={name:"y",handles:["n","s"].map(Vn),input:function(e,t){return e==null?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},Zy={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Vn),input:function(e){return e==null?null:Ff(e)},output:function(e){return e}}});var wo=f(()=>{vo()});var So=f(()=>{});var bo=f(()=>{});var jo=f(()=>{});var Vo=f(()=>{});var To=f(()=>{});var Eo=f(()=>{});var Co=f(()=>{});var Io=f(()=>{});function Mo(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function ke(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}var Vt=f(()=>{});function Ao(e){return e=ke(Math.abs(e)),e?e[1]:NaN}var Ro=f(()=>{Vt()});function ko(e,t){return function(r,n){for(var a=r.length,i=[],s=0,o=e[0],c=0;a>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),i.push(r.substring(a-=o,a+o)),!((c+=o+1)>n));)o=e[s=(s+1)%e.length];return i.reverse().join(t)}}var Oo=f(()=>{});function Lo(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var Do=f(()=>{});function Tt(e){if(!(t=Uf.exec(e)))throw new Error("invalid format: "+e);var t;return new Tn({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Tn(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}var Uf,Yo=f(()=>{Uf=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;Tt.prototype=Tn.prototype;Tn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type}});function Xo(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var zo=f(()=>{});function Po(e,t){var r=ke(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(En=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+ke(e,Math.max(0,t+i-1))[0]}var En,Cn=f(()=>{Vt()});function In(e,t){var r=ke(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}var Fo=f(()=>{Vt()});var Mn,Uo=f(()=>{Vt();Cn();Fo();Mn={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Mo,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>In(e*100,t),r:In,s:Po,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)}});function An(e){return e}var No=f(()=>{});function Bo(e){var t=e.grouping===void 0||e.thousands===void 0?An:ko(qo.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?An:Lo(qo.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"\u2212":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function l(h){h=Tt(h);var p=h.fill,d=h.align,x=h.sign,g=h.symbol,_=h.zero,v=h.width,E=h.comma,w=h.precision,M=h.trim,k=h.type;k==="n"?(E=!0,k="g"):Mn[k]||(w===void 0&&(w=12),M=!0,k="g"),(_||p==="0"&&d==="=")&&(_=!0,p="0",d="=");var U=g==="$"?r:g==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",ce=g==="$"?n:/[%p]/.test(k)?s:"",K=Mn[k],ye=/[defgprs%]/.test(k);w=w===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function Ne(j){var he=U,H=ce,_e,Ht,qe;if(k==="c")H=K(j)+H,j="";else{j=+j;var Ge=j<0||1/j<0;if(j=isNaN(j)?c:K(Math.abs(j),w),M&&(j=Xo(j)),Ge&&+j==0&&x!=="+"&&(Ge=!1),he=(Ge?x==="("?x:o:x==="-"||x==="("?"":x)+he,H=(k==="s"?Go[8+En/3]:"")+H+(Ge&&x==="("?")":""),ye){for(_e=-1,Ht=j.length;++_e<Ht;)if(qe=j.charCodeAt(_e),48>qe||qe>57){H=(qe===46?a+j.slice(_e+1):j.slice(_e))+H,j=j.slice(0,_e);break}}}E&&!_&&(j=t(j,1/0));var Be=he.length+j.length+H.length,se=Be<v?new Array(v-Be+1).join(p):"";switch(E&&_&&(j=t(se+j,se.length?v-H.length:1/0),se=""),d){case"<":j=he+j+H+se;break;case"=":j=he+se+j+H;break;case"^":j=se.slice(0,Be=se.length>>1)+he+j+H+se.slice(Be);break;default:j=se+he+j+H;break}return i(j)}return Ne.toString=function(){return h+""},Ne}function u(h,p){var d=l((h=Tt(h),h.type="f",h)),x=Math.max(-8,Math.min(8,Math.floor(Ao(p)/3)))*3,g=Math.pow(10,-x),_=Go[8+x/3];return function(v){return d(g*v)+_}}return{format:l,formatPrefix:u}}var qo,Go,Ho=f(()=>{Ro();Oo();Do();Yo();zo();Uo();Cn();No();qo=Array.prototype.map,Go=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"]});function Rn(e){return Er=Bo(e),Qo=Er.format,Wo=Er.formatPrefix,Er}var Er,Qo,Wo,$o=f(()=>{Ho();Rn({thousands:",",grouping:[3],currency:["$",""]})});var Zo=f(()=>{$o()});var Ko=f(()=>{});var Jo=f(()=>{});var ec=f(()=>{});var tc=f(()=>{});function q(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=function(i){return e(i=new Date(+i)),i},a.ceil=function(i){return e(i=new Date(i-1)),t(i,1),e(i),i},a.round=function(i){var s=a(i),o=a.ceil(i);return i-s<o-i?s:o},a.offset=function(i,s){return t(i=new Date(+i),s==null?1:Math.floor(s)),i},a.range=function(i,s,o){var c=[],l;if(i=a.ceil(i),o=o==null?1:Math.floor(o),!(i<s)||!(o>0))return c;do c.push(l=new Date(+i)),t(i,o),e(i);while(l<i&&i<s);return c},a.filter=function(i){return q(function(s){if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},function(s,o){if(s>=s)if(o<0)for(;++o<=0;)for(;t(s,-1),!i(s););else for(;--o>=0;)for(;t(s,1),!i(s););})},r&&(a.count=function(i,s){return kn.setTime(+i),On.setTime(+s),e(kn),e(On),Math.floor(r(kn,On))},a.every=function(i){return i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?function(s){return n(s)%i==0}:function(s){return a.count(0,s)%i==0}):a}),a}var kn,On,Oe=f(()=>{kn=new Date,On=new Date});var Nf,Et,qf,Le,Cr,H0,Q0,Ct=f(()=>{Nf=1e3,Et=Nf*60,qf=Et*60,Le=qf*24,Cr=Le*7,H0=Le*30,Q0=Le*365});var rc,Ir,Gf,nc=f(()=>{Oe();Ct();rc=q(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Et)/Le,e=>e.getDate()-1),Ir=rc,Gf=rc.range});function De(e){return q(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,r){t.setDate(t.getDate()+r*7)},function(t,r){return(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Et)/Cr})}var It,Ke,ac,sc,je,ic,oc,cc,Bf,Hf,Qf,Wf,$f,Zf,lc=f(()=>{Oe();Ct();It=De(0),Ke=De(1),ac=De(2),sc=De(3),je=De(4),ic=De(5),oc=De(6),cc=It.range,Bf=Ke.range,Hf=ac.range,Qf=sc.range,Wf=je.range,$f=ic.range,Zf=oc.range});var Ln,Ye,Kf,uc=f(()=>{Oe();Ln=q(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Ln.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:q(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,r){t.setFullYear(t.getFullYear()+r*e)})};Ye=Ln,Kf=Ln.range});var fc,Mr,Jf,hc=f(()=>{Oe();Ct();fc=q(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/Le},function(e){return e.getUTCDate()-1}),Mr=fc,Jf=fc.range});function Xe(e){return q(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,r){t.setUTCDate(t.getUTCDate()+r*7)},function(t,r){return(r-t)/Cr})}var Mt,Je,dc,pc,Ve,mc,gc,xc,eh,th,rh,nh,ah,sh,yc=f(()=>{Oe();Ct();Mt=Xe(0),Je=Xe(1),dc=Xe(2),pc=Xe(3),Ve=Xe(4),mc=Xe(5),gc=Xe(6),xc=Mt.range,eh=Je.range,th=dc.range,rh=pc.range,nh=Ve.range,ah=mc.range,sh=gc.range});var Dn,ze,ih,_c=f(()=>{Oe();Dn=q(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});Dn.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:q(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,r){t.setUTCFullYear(t.getUTCFullYear()+r*e)})};ze=Dn,ih=Dn.range});var Yn=f(()=>{nc();lc();uc();hc();yc();_c()});function Xn(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function zn(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function At(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function Pn(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,o=e.months,c=e.shortMonths,l=Rt(a),u=kt(a),h=Rt(i),p=kt(i),d=Rt(s),x=kt(s),g=Rt(o),_=kt(o),v=Rt(c),E=kt(c),w={a:Ge,A:Be,b:se,B:Tl,c:null,d:Vc,e:Vc,f:Ih,g:zh,G:Fh,H:Th,I:Eh,j:Ch,L:Tc,m:Mh,M:Ah,p:El,q:Cl,Q:Rc,s:kc,S:Rh,u:kh,U:Oh,V:Lh,w:Dh,W:Yh,x:null,X:null,y:Xh,Y:Ph,Z:Uh,"%":Ac},M={a:Il,A:Ml,b:Al,B:Rl,c:null,d:Cc,e:Cc,f:Bh,g:rd,G:ad,H:Nh,I:qh,j:Gh,L:Ic,m:Hh,M:Qh,p:kl,q:Ol,Q:Rc,s:kc,S:Wh,u:$h,U:Zh,V:Kh,w:Jh,W:ed,x:null,X:null,y:td,Y:nd,Z:sd,"%":Ac},k={a:Ne,A:j,b:he,B:H,c:_e,d:bc,e:bc,f:Sh,g:Sc,G:wc,H:jc,I:jc,j:yh,L:wh,m:xh,M:_h,p:ye,q:gh,Q:jh,s:Vh,S:vh,u:fh,U:hh,V:dh,w:uh,W:ph,x:Ht,X:qe,y:Sc,Y:wc,Z:mh,"%":bh};w.x=U(r,w),w.X=U(n,w),w.c=U(t,w),M.x=U(r,M),M.X=U(n,M),M.c=U(t,M);function U(y,b){return function(V){var m=[],Q=-1,A=0,J=y.length,ee,Ie,sa;for(V instanceof Date||(V=new Date(+V));++Q<J;)y.charCodeAt(Q)===37&&(m.push(y.slice(A,Q)),(Ie=vc[ee=y.charAt(++Q)])!=null?ee=y.charAt(++Q):Ie=ee==="e"?" ":"0",(sa=b[ee])&&(ee=sa(V,Ie)),m.push(ee),A=Q+1);return m.push(y.slice(A,Q)),m.join("")}}function ce(y,b){return function(V){var m=At(1900,void 0,1),Q=K(m,y,V+="",0),A,J;if(Q!=V.length)return null;if("Q"in m)return new Date(m.Q);if("s"in m)return new Date(m.s*1e3+("L"in m?m.L:0));if(b&&!("Z"in m)&&(m.Z=0),"p"in m&&(m.H=m.H%12+m.p*12),m.m===void 0&&(m.m="q"in m?m.q:0),"V"in m){if(m.V<1||m.V>53)return null;"w"in m||(m.w=1),"Z"in m?(A=zn(At(m.y,0,1)),J=A.getUTCDay(),A=J>4||J===0?Je.ceil(A):Je(A),A=Mr.offset(A,(m.V-1)*7),m.y=A.getUTCFullYear(),m.m=A.getUTCMonth(),m.d=A.getUTCDate()+(m.w+6)%7):(A=Xn(At(m.y,0,1)),J=A.getDay(),A=J>4||J===0?Ke.ceil(A):Ke(A),A=Ir.offset(A,(m.V-1)*7),m.y=A.getFullYear(),m.m=A.getMonth(),m.d=A.getDate()+(m.w+6)%7)}else("W"in m||"U"in m)&&("w"in m||(m.w="u"in m?m.u%7:"W"in m?1:0),J="Z"in m?zn(At(m.y,0,1)).getUTCDay():Xn(At(m.y,0,1)).getDay(),m.m=0,m.d="W"in m?(m.w+6)%7+m.W*7-(J+5)%7:m.w+m.U*7-(J+6)%7);return"Z"in m?(m.H+=m.Z/100|0,m.M+=m.Z%100,zn(m)):Xn(m)}}function K(y,b,V,m){for(var Q=0,A=b.length,J=V.length,ee,Ie;Q<A;){if(m>=J)return-1;if(ee=b.charCodeAt(Q++),ee===37){if(ee=b.charAt(Q++),Ie=k[ee in vc?b.charAt(Q++):ee],!Ie||(m=Ie(y,V,m))<0)return-1}else if(ee!=V.charCodeAt(m++))return-1}return m}function ye(y,b,V){var m=l.exec(b.slice(V));return m?(y.p=u.get(m[0].toLowerCase()),V+m[0].length):-1}function Ne(y,b,V){var m=d.exec(b.slice(V));return m?(y.w=x.get(m[0].toLowerCase()),V+m[0].length):-1}function j(y,b,V){var m=h.exec(b.slice(V));return m?(y.w=p.get(m[0].toLowerCase()),V+m[0].length):-1}function he(y,b,V){var m=v.exec(b.slice(V));return m?(y.m=E.get(m[0].toLowerCase()),V+m[0].length):-1}function H(y,b,V){var m=g.exec(b.slice(V));return m?(y.m=_.get(m[0].toLowerCase()),V+m[0].length):-1}function _e(y,b,V){return K(y,t,b,V)}function Ht(y,b,V){return K(y,r,b,V)}function qe(y,b,V){return K(y,n,b,V)}function Ge(y){return s[y.getDay()]}function Be(y){return i[y.getDay()]}function se(y){return c[y.getMonth()]}function Tl(y){return o[y.getMonth()]}function El(y){return a[+(y.getHours()>=12)]}function Cl(y){return 1+~~(y.getMonth()/3)}function Il(y){return s[y.getUTCDay()]}function Ml(y){return i[y.getUTCDay()]}function Al(y){return c[y.getUTCMonth()]}function Rl(y){return o[y.getUTCMonth()]}function kl(y){return a[+(y.getUTCHours()>=12)]}function Ol(y){return 1+~~(y.getUTCMonth()/3)}return{format:function(y){var b=U(y+="",w);return b.toString=function(){return y},b},parse:function(y){var b=ce(y+="",!1);return b.toString=function(){return y},b},utcFormat:function(y){var b=U(y+="",M);return b.toString=function(){return y},b},utcParse:function(y){var b=ce(y+="",!0);return b.toString=function(){return y},b}}}function T(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function lh(e){return e.replace(ch,"\\$&")}function Rt(e){return new RegExp("^(?:"+e.map(lh).join("|")+")","i")}function kt(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function uh(e,t,r){var n=P.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function fh(e,t,r){var n=P.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function hh(e,t,r){var n=P.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function dh(e,t,r){var n=P.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function ph(e,t,r){var n=P.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function wc(e,t,r){var n=P.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function Sc(e,t,r){var n=P.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function mh(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function gh(e,t,r){var n=P.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function xh(e,t,r){var n=P.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function bc(e,t,r){var n=P.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function yh(e,t,r){var n=P.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function jc(e,t,r){var n=P.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function _h(e,t,r){var n=P.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function vh(e,t,r){var n=P.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function wh(e,t,r){var n=P.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function Sh(e,t,r){var n=P.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function bh(e,t,r){var n=oh.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function jh(e,t,r){var n=P.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function Vh(e,t,r){var n=P.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function Vc(e,t){return T(e.getDate(),t,2)}function Th(e,t){return T(e.getHours(),t,2)}function Eh(e,t){return T(e.getHours()%12||12,t,2)}function Ch(e,t){return T(1+Ir.count(Ye(e),e),t,3)}function Tc(e,t){return T(e.getMilliseconds(),t,3)}function Ih(e,t){return Tc(e,t)+"000"}function Mh(e,t){return T(e.getMonth()+1,t,2)}function Ah(e,t){return T(e.getMinutes(),t,2)}function Rh(e,t){return T(e.getSeconds(),t,2)}function kh(e){var t=e.getDay();return t===0?7:t}function Oh(e,t){return T(It.count(Ye(e)-1,e),t,2)}function Ec(e){var t=e.getDay();return t>=4||t===0?je(e):je.ceil(e)}function Lh(e,t){return e=Ec(e),T(je.count(Ye(e),e)+(Ye(e).getDay()===4),t,2)}function Dh(e){return e.getDay()}function Yh(e,t){return T(Ke.count(Ye(e)-1,e),t,2)}function Xh(e,t){return T(e.getFullYear()%100,t,2)}function zh(e,t){return e=Ec(e),T(e.getFullYear()%100,t,2)}function Ph(e,t){return T(e.getFullYear()%1e4,t,4)}function Fh(e,t){var r=e.getDay();return e=r>=4||r===0?je(e):je.ceil(e),T(e.getFullYear()%1e4,t,4)}function Uh(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+T(t/60|0,"0",2)+T(t%60,"0",2)}function Cc(e,t){return T(e.getUTCDate(),t,2)}function Nh(e,t){return T(e.getUTCHours(),t,2)}function qh(e,t){return T(e.getUTCHours()%12||12,t,2)}function Gh(e,t){return T(1+Mr.count(ze(e),e),t,3)}function Ic(e,t){return T(e.getUTCMilliseconds(),t,3)}function Bh(e,t){return Ic(e,t)+"000"}function Hh(e,t){return T(e.getUTCMonth()+1,t,2)}function Qh(e,t){return T(e.getUTCMinutes(),t,2)}function Wh(e,t){return T(e.getUTCSeconds(),t,2)}function $h(e){var t=e.getUTCDay();return t===0?7:t}function Zh(e,t){return T(Mt.count(ze(e)-1,e),t,2)}function Mc(e){var t=e.getUTCDay();return t>=4||t===0?Ve(e):Ve.ceil(e)}function Kh(e,t){return e=Mc(e),T(Ve.count(ze(e),e)+(ze(e).getUTCDay()===4),t,2)}function Jh(e){return e.getUTCDay()}function ed(e,t){return T(Je.count(ze(e)-1,e),t,2)}function td(e,t){return T(e.getUTCFullYear()%100,t,2)}function rd(e,t){return e=Mc(e),T(e.getUTCFullYear()%100,t,2)}function nd(e,t){return T(e.getUTCFullYear()%1e4,t,4)}function ad(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Ve(e):Ve.ceil(e),T(e.getUTCFullYear()%1e4,t,4)}function sd(){return"+0000"}function Ac(){return"%"}function Rc(e){return+e}function kc(e){return Math.floor(+e/1e3)}var vc,P,oh,ch,Oc=f(()=>{Yn();vc={"-":"",_:" ","0":"0"},P=/^\s*\d+/,oh=/^%/,ch=/[\\^$*+?|[\]().{}]/g});function Fn(e){return et=Pn(e),Lc=et.format,Dc=et.parse,Yc=et.utcFormat,Xc=et.utcParse,et}var et,Lc,Dc,Yc,Xc,zc=f(()=>{Oc();Fn({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})});var Pc=f(()=>{zc()});var Fc=f(()=>{});var Uc=f(()=>{});var Nc=f(()=>{});var qc=f(()=>{});var Gc=f(()=>{});function Pe(e,t,r){this.k=e,this.x=t,this.y=r}function Nn(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Un;return e.__zoom}var Un,qn=f(()=>{Pe.prototype={constructor:Pe,scale:function(e){return e===1?this:new Pe(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Pe(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Un=new Pe(1,0,0);Nn.prototype=Pe.prototype});var Bc=f(()=>{});var Hc=f(()=>{Tr();qc();Gc();qn();Bc()});var Qc=f(()=>{Hc();qn()});var Ot=f(()=>{ua();fa();ha();wo();bo();cr();jo();Vo();Wr();Fs();To();jn();Eo();Io();Zo();Ko();Jo();pt();So();ec();Co();tc();Fc();Uc();ie();Nc();Yn();Pc();_r();Tr();Qc()});var Wc=f(()=>{Wt();Ot();O.register("SliderTransformer",{constructor:O,redraw:({layer:e,transformer:t})=>{L(e.getGraphic()).selectAll(":not(.ig-layer-background)").remove();let r=t.getSharedVar("x1")??0,n=t.getSharedVar("x2")??0,a=t.getSharedVar("height")??0,i=t.getSharedVar("fill")??"#000000",s=t.getSharedVar("opacity")??.3;L(e.getGraphic()).append("rect").attr("x1",r).attr("x2",n).attr("width",n-r).attr("height",a).attr("fill",i).attr("opacity",s)}});O.register("TransientRectangleTransformer",{constructor:O,redraw:({layer:e,transformer:t})=>{L(e.getGraphic()).selectAll(":not(.ig-layer-background)").remove(),L(e.getGraphic()).append("rect").attr("x",t.getSharedVar("x")).attr("y",t.getSharedVar("y")).attr("width",t.getSharedVar("width")).attr("height",t.getSharedVar("height")).attr("fill",t.getSharedVar("fillColor")).attr("opacity",t.getSharedVar("opacity"))}});O.register("HighlightSelection",{constructor:O,redraw({layer:e,transformer:t}){let r=L(e.getGraphic()).selectAll(t.getSharedVar("selector")||"*");Object.entries(t.getSharedVar("highlightAttrValues")).forEach(([a,i])=>{r.attr(a,i)})}});O.register("TransientRectangleTransformer",{constructor:O,redraw:({layer:e,transformer:t})=>{L(e.getGraphic()).selectAll(":not(.ig-layer-background)").remove(),L(e.getGraphic()).append("rect").attr("x",t.getSharedVar("x")).attr("y",t.getSharedVar("y")).attr("width",t.getSharedVar("width")).attr("height",t.getSharedVar("height")).attr("fill",t.getSharedVar("fillColor")).attr("opacity",t.getSharedVar("opacity"))}});O.register("SelectionTransformer",{constructor:O,redraw:({layer:e,transformer:t})=>{t.getSharedVar("selectionResult").forEach(a=>{e.getGraphic().appendChild(a)});let r=t.getSharedVar("highlightColor"),n=Object.entries(t.getSharedVar("highlightAttrValues")||{});if(r||n.length){let a=ut(t.getSharedVar("selectionResult"));r&&a.attr("fill",r).attr("stroke",r),n.forEach(([i,s])=>{a.attr(i,s)})}}});O.register("HelperLineTransformer",{constructor:O,transient:!0,sharedVar:{orientation:["horizontal","vertical"],style:{}},redraw({layer:e,transformer:t}){let r=e.getLayerFromQueue("mainLayer"),n=t.getSharedVar("orientation"),a=t.getSharedVar("style"),i=t.getSharedVar("x"),s=t.getSharedVar("y"),o=t.getSharedVar("tooltip"),c=t.getSharedVar("scaleX"),l=t.getSharedVar("scaleY"),u=[],h=0,p=0;o&&(typeof o=="object"&&o.prefix&&u.push(o.prefix),c&&c.invert&&typeof i=="number"&&u.push(c.invert(i-(e._offset?.x??0))),l&&l.invert&&typeof s=="number"&&u.push(l.invert(s-(e._offset?.y??0))),typeof o=="object"&&o.suffix&&u.push(o.suffix),typeof o=="object"&&o.offset&&(typeof o.offset.x=="number"&&(h=o.offset.x),typeof o.offset.y=="number"&&(p=o.offset.y),typeof o.offset.x=="function"&&typeof i=="number"&&(h=o.offset.x(i-(e._offset?.x??0))),typeof o.offset.y=="function"&&typeof s=="number"&&(p=o.offset.y(s-(e._offset?.y??0)))));let d=u.join(" ");if(n.includes("horizontal")&&typeof s=="number"){let x=L(e.getGraphic()).append("line").attr("x1",0).attr("x2",r.getGraphic().getBoundingClientRect().width).attr("y1",s-(e._offset?.y??0)).attr("y2",s-(e._offset?.y??0)).attr("stroke-width",1).attr("stroke","#000");a&&Object.entries(a).forEach(([g,_])=>{x.attr(g,_)})}if(n.includes("vertical")&&typeof i=="number"){let x=L(e.getGraphic()).append("line").attr("y1",0).attr("y2",r.getGraphic().getBoundingClientRect().height).attr("x1",i-(e._offset?.x??0)).attr("x2",i-(e._offset?.x??0)).attr("stroke-width",1).attr("stroke","#000");a&&Object.entries(a).forEach(([g,_])=>{x.attr(g,_)})}d&&L(e.getGraphic()).append("text").attr("x",i-(e._offset?.x??0)).attr("y",s-(e._offset?.y??0)).text(d)}})});var Gn,ge,Fe=f(()=>{Wt();Wt();Wc();Gn=at,ge=O});var $c,tt,Ar,C,id,Ov,od,Zc,rt=f(()=>{re();Fe();tt={},Ar=[],C=class{constructor(t,r){this._linkCache={},this._transformers=[],this._joinTransformers=[],this._services=[],this._joinServices=[],this._initializing=null,this._nextTick=0,this._computing=null,this._result=null,this._oldResult=null,this[$c]=!0,r.preInitialize&&r.preInitialize.call(this,this),this._baseName=t,this._userOptions=r,this._name=r.name??t,this._sharedVar={},this._transformers=r.transformers??[],this._joinTransformers=r.joinTransformers??[],this._services=r.services??[],this._joinServices=r.joinServices??[],this._layerInstances=[],this._resultAlias=r.resultAlias,this._preInitialize=r.preInitialize??null,this._postInitialize=r.postInitialize??null,this._preUpdate=r.preUpdate??null,this._preAttach=r.preAttach??null,this._postUse=r.postUse??null,this._initializing=Promise.all(Object.entries(r.sharedVar||{}).map(n=>this.setSharedVar(n[0],n[1]))).then(async()=>{r.postUpdate&&r.postUpdate.call(this,this),this._postUpdate=r.postUpdate??null,this._initializing=null}),r.layer&&this._layerInstances.push(r.layer),Ar.push(this),r.postInitialize&&r.postInitialize.call(this,this)}getSharedVar(t,r){if(!(r&&r.layer&&this._layerInstances.length&&!this._layerInstances.includes(r.layer)))return!(t in this._sharedVar)&&r&&"defaultValue"in r&&this.setSharedVar(t,r.defaultValue,r),this._sharedVar[t]}async setSharedVar(t,r,n){if(this.preUpdate(),this._sharedVar[t]=r,this._userOptions.evaluate&&this._resultAlias){if(this._nextTick)return;this._nextTick=requestAnimationFrame(async()=>{this._oldResult=this._result;try{this._computing=this._userOptions.evaluate({self:this,...this._userOptions.params??{},...this._sharedVar}),this._result=await this._computing,this._computing=null,this._services.forEach(a=>{a.setSharedVar(this._resultAlias,this._result)}),this._transformers.forEach(a=>{a.setSharedVars({[this._resultAlias]:this._result})})}catch(a){console.error(a),this._result=void 0,this._computing=null}this._nextTick=0,this.postUpdate()})}else this.postUpdate()}async setSharedVars(t,r){Object.entries(t).forEach(([n,a])=>{this._sharedVar[n]=a}),Object.keys(t).length>0&&await this.setSharedVar(...Object.entries(t)[0],r)}async join(){if(this._resultAlias){let t=await this._internalResults;this._joinServices&&this._joinServices.length?await Promise.all(this._joinServices.map(async r=>(await r.setSharedVar(this._resultAlias,t),r.results))):this._initializing||await Promise.all(this._services.map(async r=>(await r.setSharedVar(this._resultAlias,t),r.results))),this._joinTransformers&&this._joinTransformers.length?await Promise.all(this._joinTransformers.map(r=>r.setSharedVar(this._resultAlias,t))):this._initializing||await Promise.all(this._transformers.map(r=>r.setSharedVar(this._resultAlias,t)))}}preUpdate(){this._preUpdate&&this._preUpdate.call(this,this)}postUpdate(){this._postUpdate&&this._postUpdate.call(this,this)}preAttach(t){this._preAttach&&this._preAttach.call(this,this,t)}postUse(t){this._postUse&&this._postUse.call(this,this,t)}isInstanceOf(t){return this._baseName===t||this._name===t}get transformers(){return $(this._transformers.slice(0),ge,t=>this._transformers.push(t),t=>{t.setSharedVars({...this._resultAlias?{[this._resultAlias]:null}:{},selectionResult:[],layoutResult:null,result:null}),this._transformers.splice(this._transformers.indexOf(t),1)},this)}get services(){return $(this._services.slice(0),C,t=>this._services.push(t),t=>{Object.entries({...this._resultAlias?{[this._resultAlias]:null}:{},selectionResult:[],layoutResult:null,result:null}).forEach(([r,n])=>{t.setSharedVar(r,n)}),this._services.splice(this._services.indexOf(t),1)},this)}get _internalResults(){return this._nextTick?new Promise(t=>{window.requestAnimationFrame(async()=>{this._computing?t(await this._computing):t(this._result)})}):this._computing||this._result}get results(){return this._initializing?this._initializing.then(()=>this._internalResults):this._internalResults}get oldResults(){return this._initializing?this._initializing.then(()=>this._nextTick?new Promise(t=>{window.requestAnimationFrame(async()=>{this._computing&&await this._computing,t(this._oldResult)})}):this._oldResult):this._nextTick?new Promise(t=>{window.requestAnimationFrame(async()=>{this._computing&&await this._computing,t(this._oldResult)})}):this._oldResult}static register(t,r){tt[t]=r}static unregister(t){return delete tt[t],!0}static initialize(t,r){let n=Object.assign({constructor:C},tt[t]??{},r??{},{on:Object.assign({},(tt[t]??{}).on??{},r?.on??{}),sharedVar:Object.assign({},(tt[t]??{}).sharedVar??{},r?.sharedVar??{}),params:Object.assign({},(tt[t]??{}).params??{},r?.params??{})});return new n.constructor(t,n)}static findService(t){return Ar.filter(r=>r.isInstanceOf(t))}};$c=W;id=C.register,Ov=C.unregister,od=C.initialize,Zc=C.findService});var fe,Kc=f(()=>{rt();re();Fe();fe=class extends C{constructor(t,r){super(t,{...r,resultAlias:r?.resultAlias??"selectionResult"});this._currentDimension=[],this._transformers.push(ge.initialize("SelectionTransformer",{transient:!0,sharedVar:{[this._resultAlias]:[],layer:null,highlightColor:r?.sharedVar?.highlightColor,highlightAttrValues:r?.sharedVar?.highlightAttrValues}})),this._selectionMapping=new Map,Object.entries({...this._userOptions?.query?.attrName?typeof this._userOptions.query.attrName=="string"?{[this._userOptions.query.attrName]:this._userOptions?.query?.extent??[]}:Object.fromEntries(this._userOptions.query.attrName.map((n,a)=>[n,this._userOptions?.query?.extent?.[a]??[]])):{},...this._sharedVar?.attrName?typeof this._sharedVar.attrName=="string"?{[this._sharedVar.attrName]:this._sharedVar?.extent??[]}:Object.fromEntries(this._sharedVar.attrName.map((n,a)=>[n,this._sharedVar?.extent?.[a]??[]])):{}}).filter(([n,a])=>a instanceof Array).forEach(([n,a])=>this._selectionMapping.set(n,a))}async setSharedVar(t,r,n){if(!(n&&n.layer&&this._layerInstances.length!==0&&!this._layerInstances.includes(n.layer)))if(this.preUpdate(),this._sharedVar[t]=r,(n?.layer||this._layerInstances.length==1)&&this._userOptions.query){let a=n?.layer||this._layerInstances[0];if(this._nextTick)return;this._nextTick=requestAnimationFrame(async()=>{this._evaluate(a)})}else this.postUpdate()}_evaluate(t){if(!t)return;this._oldResult=this._result,this._result=t.picking({...this._userOptions.query,...this._sharedVar});let r=t.getLayerFromQueue("selectionLayer").getGraphic();for(;r.firstChild;)r.removeChild(r.lastChild);if(this._sharedVar.deepClone){let n=[],a=[];this._result.forEach(i=>{if(i!==t.getGraphic()){let s=a.length;for(let o=0;o<s;o++){let c=a[o],l=n[o];i.contains(c)&&(a.splice(o,1),n.splice(o,1),l.remove(),o--,s--)}n.push(t.cloneVisualElements(i,!0)),a.push(i)}}),this._services.forEach(i=>{i.setSharedVar(this._resultAlias,n)}),this._transformers.forEach(i=>{i.setSharedVars({layer:t.getLayerFromQueue("selectionLayer"),[this._resultAlias]:n})})}else this._services.forEach(n=>{n.setSharedVar(this._resultAlias,this._result.map(a=>t.cloneVisualElements(a,!1)))}),this._transformers.forEach(n=>{n.setSharedVars({layer:t.getLayerFromQueue("selectionLayer"),[this._resultAlias]:this._result.map(a=>t.cloneVisualElements(a,!1))})});this._nextTick=0,this.postUpdate()}isInstanceOf(t){return t==="SelectionService"||this._baseName===t||this._name===t}dimension(t,r){let n=[],a=[];typeof t=="string"?(n=[t],a=[r??(s=>s)]):(n=G(t),a=r??n.map(()=>s=>s));let i=n.map((s,o)=>[s,a[o]]);return this._currentDimension=i,new Proxy(this,{get(s,o){return o==="dimension"?s.dimension.bind(s):o==="_currentDimension"?i:s[o]},set(s,o,c){return s[o]=c,!0}})}filter(t,r){if(r&&r.layer&&this._layerInstances.length!==0&&!this._layerInstances.includes(r.layer))return this;let n=r?.layer||this._layerInstances[0];return this._currentDimension.length===0&&t instanceof Array&&t.length>0?(this._sharedVar.attrName&&(this._userOptions.query.attrName=this._sharedVar.attrName),this._userOptions.query.attrName&&this.dimension(this._userOptions.query.attrName).filter(t)):this._currentDimension.length===1&&t instanceof Array&&t.length>0&&!(t[0]instanceof Array)?(this._selectionMapping.set(this._currentDimension[0][0],this._currentDimension[0][1](t).sort((a,i)=>typeof a=="number"?a-i:a<i?-1:a==i?0:1)),this._sharedVar.attrName=[...this._selectionMapping.keys()],this._sharedVar.extent=[...this._selectionMapping.values()],this._evaluate(n),this._services.forEach(a=>{a.setSharedVar("extents",this.extents)}),this._transformers.forEach(a=>{a.setSharedVar("extents",this.extents)})):this._currentDimension.length===t.length&&t.every(a=>a instanceof Array)&&(this._currentDimension.forEach((a,i)=>{this._selectionMapping.set(a[0],a[1](t[i]).sort((s,o)=>typeof s=="number"?s-o:s<o?-1:s==o?0:1))}),this._sharedVar.attrName=[...this._selectionMapping.keys()],this._sharedVar.extent=[...this._selectionMapping.values()],this._evaluate(n),this._services.forEach(a=>{a.setSharedVar("extents",this.extents)}),this._transformers.forEach(a=>{a.setSharedVar("extents",this.extents)})),this}get extents(){return Object.fromEntries(this._selectionMapping.entries())}};C.SelectionService=fe;C.register("SelectionService",{constructor:fe});C.register("SurfacePointSelectionService",{constructor:fe,query:{baseOn:z.Shape,type:D.SurfacePoint,x:0,y:0}});C.register("PointSelectionService",{constructor:fe,query:{baseOn:z.Shape,type:D.Point,x:0,y:0}});C.register("RectSelectionService",{constructor:fe,query:{baseOn:z.Shape,type:D.Rect,x:0,y:0,width:1,height:1}});C.register("CircleSelectionService",{constructor:fe,query:{baseOn:z.Shape,type:D.Circle,x:0,y:0,r:1}});C.register("PolygonSelectionService",{constructor:fe,query:{baseOn:z.Shape,type:D.Polygon,points:[]}});C.register("QuantitativeSelectionService",{constructor:fe,query:{baseOn:z.Data,type:Te.Quantitative,attrName:"",extent:[0,0]}})});var Rr,Jc=f(()=>{rt();Rr=class extends C{constructor(t,r){super(t,{...r,resultAlias:r.resultAlias??"layoutResult"})}isInstanceOf(t){return t==="LayoutService"||this._baseName===t||this._name===t}};C.LayoutService=Rr;C.register("LayoutService",{constructor:Rr})});var kr,el=f(()=>{rt();kr=class extends C{constructor(t,r){super(t,{...r,resultAlias:r.resultAlias??"result"})}isInstanceOf(t){return t==="AnalysisService"||this._baseName===t||this._name===t}};C.AnalysisService=kr;C.register("AnalysisService",{constructor:kr})});var tl,Bn,Lt,Dt=f(()=>{rt();rt();Kc();Jc();el();tl=Zc,Bn=Ar,Lt=C});var rl,nl=f(()=>{rl=`#JSGF V1.0;

grammar actions;

public <action> = start | stop | pause | resume | play | delete | add | insert | create | remove | drag | move | drag | brush;`});function ud(e){let t=e.events.map(r=>Qn(r)[0]);return{...e,eventStreams:t.map(r=>fd(r))}}function fd(e){return e.filter?{...e,filterFuncs:e.filter?e.filter.map(t=>new Function("event",`return ${t}`)):[]}:{...e}}var al,cd,ld,Hn,Or,I,Jv,ew,tw,rw,Lr=f(()=>{re();nl();cd=window.SpeechRecognition||window.webkitSpeechRecognition,ld=window.SpeechGrammarList||window.webkitSpeechGrammarList,Hn={},Or=[],I=class{constructor(t,r){this[al]=!0,r.preInitialize&&r.preInitialize.call(this,this),this._baseName=t,this._userOptions=r,this._name=r.name??t,this._state=r.state,this._actions=G(r.actions??[]).map(ud),this._modalities={},this._preInitialize=r.preInitialize??null,this._postInitialize=r.postInitialize??null,this._preUse=r.preUse??null,this._postUse=r.postUse??null,r.postInitialize&&r.postInitialize.call(this,this)}enableModality(t){switch(t){case"speech":if(this._modalities.speech)break;let r=new cd;this._modalities.speech=r;let n=new ld;n.addFromString(rl),r.grammars=n,r.lang="en-US";break}}disableModality(t){switch(t){case"speech":this._modalities.speech&&(this._modalities.speech.onresult=null,this._modalities.speech.onend=null,this._modalities.speech.abort(),this._modalities.speech=null);break}}getActions(){return this._actions.slice(0)}setActions(t){let r=t.concat(this._actions);this._actions=r.filter((n,a)=>a===r.findIndex(i=>i.action===n.action))}_parseEvent(t){let r=n=>"stream"in n?n.between.concat(n.stream).flatMap(r):"between"in n?n.between.concat([{type:n.type}]).flatMap(r):n.type;return Qn(t).flatMap(r)}getAcceptEvents(){return[...new Set(this._actions.flatMap(t=>t.eventStreams.flatMap(r=>r.type)).concat(["contextmenu"]))]}async dispatch(t,r){let n=this._actions.find(a=>{let i=a.eventStreams.map(o=>o.type),s=!1;return i.includes("*")&&(s=!0),t instanceof Event?s=a.eventStreams.filter(o=>o.type===t.type).some(o=>o.filterFuncs?o.filterFuncs.every(c=>c(t)):!0):i.includes(t)&&(s=!0),s&&(!a.transition||a.transition.find(o=>o[0]===this._state||o[0]==="*"))});if(n){t instanceof Event&&(t.preventDefault(),t.stopPropagation());let a=n.transition&&n.transition.find(i=>i[0]===this._state||i[0]==="*");if(a){if(this._state=a[1],this._state.startsWith("speech:")){this.enableModality("speech");try{this._modalities.speech.start()}catch{}this._modalities.speech.onresult=i=>{let s=i.results[i.resultIndex][0];this.dispatch(s.transcript,r)},this._modalities.speech.onend=i=>{this._modalities.speech.start()}}else this.disableModality("speech");if(n.sideEffect)try{await n.sideEffect({self:this,layer:r,instrument:null,interactor:this,event:t})}catch(i){console.error(i)}return!0}}return!1}preUse(t){this._preUse&&this._preUse.call(this,this,t)}postUse(t){this._postUse&&this._postUse.call(this,this,t)}isInstanceOf(t){return this._baseName===t||this._name===t}static register(t,r){Hn[t]=r}static unregister(t){return delete Hn[t],!0}static initialize(t,r){let n=Object.assign({constructor:I},Hn[t]??{},r??{}),a=new n.constructor(t,n);return Or.push(a),a}static findInteractor(t){return Or.filter(r=>r.isInstanceOf(t))}};al=W;Jv=I.register,ew=I.unregister,tw=I.initialize,rw=I.findInteractor});var sl=f(()=>{Lr();I.register("MousePositionInteractor",{constructor:I,state:"start",actions:[{action:"hover",events:["mousemove"],transition:[["start","start"]]}]});I.register("TouchPositionInteractor",{constructor:I,state:"start",actions:[{action:"enter",events:["touchstart"],transition:[["start","running"]]},{action:"hover",events:["touchmove"],transition:[["running","running"]]},{action:"leave",events:["touchend"],transition:[["running","start"],["start","start"]]}]});I.register("MouseTraceInteractor",{constructor:I,state:"start",actions:[{action:"dragstart",events:["mousedown"],transition:[["start","drag"]]},{action:"drag",events:["mousemove"],transition:[["drag","drag"]]},{action:"dragend",events:["mouseup[event.button==0]"],transition:[["drag","start"]]},{action:"dragabort",events:["mouseup[event.button==2]"],transition:[["drag","start"],["start","start"]]}]});I.register("TouchTraceInteractor",{constructor:I,state:"start",actions:[{action:"dragstart",events:["touchstart"],transition:[["start","drag"]]},{action:"drag",events:["touchmove"],transition:[["drag","drag"]]},{action:"dragend",events:["touchend"],transition:[["drag","start"]]}]});I.register("SpeechControlInteractor",{constructor:I,state:"start",actions:[{action:"enableSpeech",events:["click"],transition:[["*","speech:ready"]]},{action:"disableSpeech",events:["mouseup[event.button==2]"],transition:[["*","start"]]},{action:"speech",events:["*"],transition:[["*","speech:ready"]]}]});I.register("KeyboardPositionInteractor",{constructor:I,state:"start",actions:[{action:"begin",events:["keydown[event.key===' ']"],transition:[["start","running"]]},{action:"up",events:["keypress[event.key==='w' || event.key==='W']","keydown[event.key==='ArrowUp']{100}"],transition:[["running","running"]]},{action:"left",events:["keypress[event.key==='a' || event.key==='A']","keydown[event.key==='ArrowLeft']{100}"],transition:[["running","running"]]},{action:"down",events:["keypress[event.key==='s' || event.key==='S']","keydown[event.key==='ArrowDown']{100}"],transition:[["running","running"]]},{action:"right",events:["keypress[event.key==='d' || event.key==='D']","keydown[event.key==='ArrowRight']{100}"],transition:[["running","running"]]}]});I.register("MouseWheelInteractor",{constructor:I,state:"start",actions:[{action:"enter",events:["mouseenter"],transition:[["start","running"]]},{action:"wheel",events:["wheel","mousewheel"],transition:[["running","running"]]},{action:"leave",events:["mouseleave"],transition:[["running","start"],["start","start"]]},{action:"abort",events:["mouseup[event.button==2]"],transition:[["running","running"],["start","start"]]}]})});var lw,uw,fw,Wn,xe,Yt=f(()=>{Lr();Lr();sl();lw=I.register,uw=I.initialize,fw=I.findInteractor,Wn=Or,xe=I});function ll(e,t){ol[e]=t}function ul(e,t){let r=Object.assign({constructor:Y},ol[e]??{},t??{},{});return new r.constructor(e,r)}function fl(e){return cl.filter(t=>t.isInstanceOf(e))}var il,ol,cl,nt,Ee,Y,Xt=f(()=>{re();ol={},cl=[],nt=new Map,Ee=new Map,Y=class{constructor(t,r){this._nextTick=0,this[il]=!0,r.preInitialize&&r.preInitialize.call(this,this),this._baseName=t,this._userOptions=r,this._name=r.name??t,this._container=r.container,this._order=0,this._preInitialize=r.preInitialize??null,this._postInitialize=r.postInitialize??null,this._preUpdate=r.preUpdate??null,this._postUpdate=r.postUpdate??null,cl.push(this),this._postInitialize&&this._postInitialize.call(this,this)}getGraphic(){return this._graphic}getContainerGraphic(){return this._container}getVisualElements(){return[]}cloneVisualElements(t,r=!1){let n=t.cloneNode(r);return document.createDocumentFragment().append(n),n}join(t,r){return[]}preUpdate(){this._preUpdate&&this._preUpdate.call(this,this)}postUpdate(){this._postUpdate&&this._postUpdate.call(this,this)}picking(t){return[]}getLayerFromQueue(t){nt.has(this)||nt.set(this,{[this._name]:this}),Ee.has(this)||Ee.set(this,{[this._name]:0});let r=nt.get(this);if(!(t in r)){let n=Y.initialize(this._baseName,{...this._userOptions,name:t,group:"",redraw(){}});r[t]=n,nt.set(n,r);let a=r[t].getGraphic();a&&a.style&&(a.style.pointerEvents="none")}return t in Ee.get(this)||(Ee.get(this)[t]=0),r[t]}setLayersOrder(t){nt.has(this)||nt.set(this,{[this._name]:this}),Ee.has(this)||Ee.set(this,{[this._name]:0});let r=Ee.get(this),n=document.createDocumentFragment();Object.entries(t).forEach(([a,i])=>{r[a]=i}),Object.entries(r).sort((a,i)=>a[1]-i[1]).forEach(([a,i])=>{if(r[a]=i,Ee.set(this.getLayerFromQueue(a),r),i>=0){let s=this.getLayerFromQueue(a).getGraphic();s&&s.style&&(s.style.display="initial")}else{let s=this.getLayerFromQueue(a).getGraphic();s&&s.style&&(s.style.display="none")}this.getLayerFromQueue(a)._order=i,n.append(this.getLayerFromQueue(a).getGraphic())}),this.getContainerGraphic().appendChild(n)}isInstanceOf(t){return this._baseName===t||this._name===t}};il=W;Y.register=ll;Y.initialize=ul;Y.findLayer=fl});var hl,Dr,zt,dl=f(()=>{Xt();Ot();re();hl="D3Layer",Dr="ig-layer-background",zt=class extends Y{constructor(t,r){super(t,r);this._width=r.width,this._height=r.height,this._offset=r.offset,this._name=r.name,this._graphic=L(r.container).append("g").call(a=>{this._name&&a.attr("className",this._name)}).call(a=>{this._offset&&a.attr("transform",`translate(${this._offset.x||0}, ${this._offset.y||0})`)}).node(),L(this._graphic).append("rect").attr("class",Dr).attr("width",this._width).attr("height",this._height).attr("opacity",0);let n=this._container;for(;n&&n.tagName!=="svg";)n=n.parentElement;if(n.tagName!=="svg")throw Error("Container must be wrapped in SVGSVGElement");this._svg=n,this._postInitialize&&this._postInitialize.call(this,this)}getVisualElements(){return[...this._graphic.querySelectorAll(`:root :not(.${Dr})`)]}cloneVisualElements(t,r=!1){let n=L(t).clone(r).node();return document.createDocumentFragment().append(n),n}select(t){return this._graphic.querySelectorAll(t)}picking(t){return t.baseOn===z.Shape?this._shapeQuery(t):t.baseOn===z.Data?this._dataQuery(t):t.baseOn===z.Attr?this._attrQuery(t):[]}_isElementInLayer(t){return this._graphic.contains(t)&&!t.classList.contains(Dr)}_shapeQuery(t){let r=[],n=this._svg.getBoundingClientRect(),a=this._graphic.getBoundingClientRect();if(t.type===D.SurfacePoint){let{x:s,y:o}=t;if(!isFinite(s)||!isFinite(o))return[];r=[...document.elementsFromPoint(s,o)].filter(this._isElementInLayer.bind(this)),r.length>=1&&(r=[r[0]])}else if(t.type===D.Point){let{x:s,y:o}=t;if(!isFinite(s)||!isFinite(o))return[];r=document.elementsFromPoint(s,o).filter(this._isElementInLayer.bind(this))}else if(t.type===D.Circle){let s=t.x-n.left,o=t.y-n.top,c=t.r,l=Math.floor(c*Math.sin(Math.PI/4))<<1,u=s-(l>>>1),h=o-(l>>>1),p=new Set,d=this._svg.createSVGRect();d.x=u,d.y=h,d.width=l,d.height=l,this._svg.getIntersectionList(d,this._graphic).forEach(M=>p.add(M));let x=c,g=s-c,_=o-c,v=new Set,E=this._svg.createSVGRect();E.x=g,E.y=_,E.width=x*2,E.height=x*2,this._svg.getIntersectionList(E,this._graphic).forEach(M=>v.add(M));let w=1;for(;;){for(let ye of v)p.has(ye)&&v.delete(ye);if(!v.size||w*2+l>=c*2)break;let M=Math.sqrt(c*c-Math.pow(l/2+w,2)),k=this._svg.createSVGRect();k.x=s-M,k.y=h-w,k.width=M*2,k.height=1;let U=this._svg.createSVGRect();U.x=s-M,U.y=h+l+w-1,U.width=M*2,U.height=1;let ce=this._svg.createSVGRect();ce.x=u-w,ce.y=o-M,ce.width=1,ce.height=M*2;let K=this._svg.createSVGRect();K.x=u+l+w-1,K.y=o-M,K.width=1,K.height=M*2,[k,U,ce,K].forEach(ye=>{this._svg.getIntersectionList(ye,this._graphic).forEach(Ne=>p.add(Ne))}),w++}r=[...p].filter(this._isElementInLayer.bind(this))}else if(t.type===D.Rect){let{x:s,y:o,width:c,height:l}=t,u=Math.min(s,s+c)-n.left,h=Math.min(o,o+l)-n.top,p=Math.abs(c),d=Math.abs(l),x=this._svg.createSVGRect();x.x=u,x.y=h,x.width=p,x.height=d,r=[...this._svg.getIntersectionList(x,this._graphic)].filter(g=>!g.classList.contains(Dr))}else t.type===D.Polygon;let i=[];for(;r.length>0;){let s=r.shift();i.push(s),s.parentElement.tagName==="g"&&this._graphic.contains(s.parentElement)&&this._graphic!==s.parentElement&&r.push(s.parentElement)}return i}_dataQuery(t){let r=[],n=ut(this.getVisualElements());if(t.type===Te.Quantitative){let{attrName:a,extent:i}=t;if(a instanceof Array){let s=n;a.forEach((o,c)=>{let l=i[c];s=s.filter(u=>u&&u[o]!==void 0&&l[0]<u[o]&&u[o]<l[1])}),r=s.nodes()}else r=n.filter(s=>s&&s[a]!==void 0&&i[0]<s[a]&&s[a]<i[1]).nodes()}else if(t.type===Te.Nominal){let{attrName:a,extent:i}=t;if(a instanceof Array){let s=n;a.forEach((o,c)=>{let l=i[c];s=s.filter(u=>u&&u[o]!==void 0&&l.findIndex(u[o])>=0)}),r=s.nodes()}else r=n.filter(s=>s&&s[a]!==void 0&&i.findIndex(s[a])>=0).nodes()}else if(t.type===Te.Temporal){let{attrName:a,extent:i}=t;if(a instanceof Array){let s=n;a.forEach((o,c)=>{let l=i[c],u=t.dateParser?.[c]??(h=>h);s=s.filter(h=>h&&h[o]!==void 0&&l[0].getTime()<u(h[o]).getTime()&&u(h[o]).getTime()<l[1].getTime())}),r=s.nodes()}else{let s=t.dateParser||(o=>o);r=n.filter(o=>o&&o[a]!==void 0&&i[0].getTime()<s(o[a]).getTime()&&s(o[a]).getTime()<i[1].getTime()).nodes()}}return r}_attrQuery(t){let{attrName:r,value:n}=t;return L(this._graphic).filter(i=>i[r]===n).nodes()}};Y.D3Layer=zt;Y.register(hl,{constructor:zt});Y.register(hl,{constructor:zt})});var pl,$n,Pt,ml=f(()=>{Xt();Ot();re();pl="VegaLayer",$n="background",Pt=class extends Y{constructor(t,r){super(t,r);this._name=r.name,this._container=r.container,r.group?(this._graphic=this._container.querySelector(`.${r.group}`),this._graphic.style.pointerEvents="visiblepainted"):(this._graphic=document.createElementNS("http://www.w3.org/2000/svg","svg"),r.container.appendChild(this._graphic));let n=this._container;for(;n&&n.tagName!=="svg";)n=n.parentElement;if(n.tagName!=="svg")throw Error("Container must be wrapped in SVGSVGElement");this._svg=n,this._postInitialize&&this._postInitialize.call(this,this)}getVisualElements(){return[...this._graphic.querySelectorAll(`:root :not(.${$n})`)]}getGraphic(){return this._userOptions.group?this._container:this._graphic}cloneVisualElements(t,r=!1){let n=L(t).clone(r).node(),a=n.parentElement,i=n.getAttribute("transform");for(;a&&a!=this._container;)a.getAttribute("transform")&&(i+=` ${a.getAttribute("transform")}`),a=a.parentElement;return n.setAttribute("transform",i),document.createDocumentFragment().append(n),n}select(t){return this._graphic.querySelectorAll(t)}picking(t){return t.baseOn===z.Shape?this._shapeQuery(t):t.baseOn===z.Data?this._dataQuery(t):t.baseOn===z.Attr?this._attrQuery(t):[]}_isElementInLayer(t){return this._graphic.contains(t)&&!t.classList.contains($n)}_shapeQuery(t){let r=[],n=this._svg.getBoundingClientRect(),a=this._graphic.getBoundingClientRect();if(t.type===D.SurfacePoint){let{x:s,y:o}=t;if(!isFinite(s)||!isFinite(o))return[];r=[...document.elementsFromPoint(s,o)].filter(c=>{if(!this._isElementInLayer(c))return!1;let l=c.getBoundingClientRect();return l.right>=s&&l.left<=s&&l.bottom>=o&&l.top<=o}),r.length>=1&&(r=[r[0]])}else if(t.type===D.Point){let{x:s,y:o}=t;if(!isFinite(s)||!isFinite(o))return[];r=document.elementsFromPoint(s,o).filter(c=>{if(!this._isElementInLayer(c))return!1;let l=c.getBoundingClientRect();return l.right>=s&&l.left<=s&&l.bottom>=o&&l.top<=o})}else if(t.type===D.Circle){let s=t.x,o=t.y,c=t.x-n.left,l=t.y-n.top,u=t.r,h=u,p=c-u,d=l-u,x=new Set,g=this._svg.createSVGRect();g.x=p,g.y=d,g.width=h*2,g.height=h*2,this._svg.getIntersectionList(g,this._graphic).forEach(_=>x.add(_)),r=[...x].filter(_=>{if(!this._isElementInLayer(_))return!1;let v=_.getBoundingClientRect(),E=Math.abs(s-v.left),w=Math.abs(o-v.top);return E>v.width/2+u||w>v.height/2+u?!1:E<=v.width/2||w<=v.height/2?!0:Math.pow(E-v.width/2,2)+Math.pow(w-v.height/2,2)<=u*u})}else if(t.type===D.Rect){let{x:s,y:o,width:c,height:l}=t,u=Math.min(s,s+c)-n.left,h=Math.min(o,o+l)-n.top,p=Math.abs(c),d=Math.abs(l),x=this._svg.createSVGRect();x.x=u,x.y=h,x.width=p,x.height=d,r=[...this._svg.getIntersectionList(x,this._graphic)].filter(g=>{if(!this._isElementInLayer(g))return!1;let _=g.getBoundingClientRect();return!(_.right<u+n.left||_.left>u+p+n.left||_.bottom<h+n.top||_.top>h+d+n.top)})}else t.type===D.Polygon;let i=[];for(;r.length>0;){let s=r.shift();s.classList.contains($n)||(i.push(s),s.parentElement.tagName==="g"&&this._graphic.contains(s.parentElement)&&this._graphic!==s.parentElement&&r.push(s.parentElement))}return i}_dataQuery(t){return[]}_attrQuery(t){let{attrName:r,value:n}=t;return[]}};Y.VegaLayer=Pt;Y.register(pl,{constructor:Pt});Y.register(pl,{constructor:Pt})});var Ue,Yr=f(()=>{Xt();Xt();dl();ml();Ue=Y});var gl,Ft,Xr,oe,Ut,Zn,S,hd,Ow,dd,pd,zr=f(()=>{Yt();re();Nt();Yr();Dt();Fe();Ft={},Xr=[],oe=new Map,Ut=[],Zn=!1,S=class{constructor(t,r){this._transformers=[],this._linkCache={},this[gl]=!0,r.preInitialize&&r.preInitialize.call(this,this),this._preInitialize=r.preInitialize??null,this._postInitialize=r.postInitialize??null,this._preAttach=r.preAttach??null,this._postUse=r.postUse??null,this._baseName=t,this._userOptions=r,this._name=r.name??t,this._on=Object.assign({},r.on??{}),this._interactors=[],this._layers=[],this._layerInteractors=new Map,this._services=r.services??[],this._serviceInstances=[],this._sharedVar=r.sharedVar??{},this._transformers=r.transformers??[],r.interactors&&r.interactors.forEach(n=>{typeof n=="string"?this.useInteractor(xe.initialize(n)):"options"in n?typeof n.interactor=="string"?this.useInteractor(xe.initialize(n.interactor,n.options)):this.useInteractor(n.interactor,n.options):this.useInteractor(n)}),r.layers&&r.layers.forEach(n=>{"options"in n?this.attach(n.layer,n.options):this.attach(n)}),this._services.forEach(n=>{typeof n=="string"||!("options"in n)?this.useService(n):this.useService(n.service,n.options)}),r.postInitialize&&r.postInitialize.call(this,this)}emit(t,r){this._on[t]&&this._on[t].forEach(n=>{n instanceof Ce?n.execute(Object.assign({self:this,layer:null,instrument:this,interactor:null},r||{})):n(Object.assign({self:this,layer:null,instrument:this,interactor:null},r||{}))})}on(t,r){return t instanceof Array?t.forEach(n=>{this._on[n]||(this._on[n]=[]),this._on[n].push(r)}):(this._on[t]||(this._on[t]=[]),this._on[t].push(r)),this}off(t,r){if(!!this._on[t])return this._on[t].includes(r)&&this._on[t].splice(this._on[t].indexOf(r),1),this}_use(t,r){t.preAttach(this),this._serviceInstances.push(t),t.postUse(this)}useService(t,r){typeof t!="string"&&this._serviceInstances.includes(t)||(arguments.length>=2?this._services.push({service:t,options:r}):this._services.push(t),typeof t=="string"?tl(t).forEach(a=>this._use(a,r)):this._use(t,r))}useInteractor(t,r){t.preUse(this),arguments.length>=2?this._interactors.push({interactor:t,options:r}):this._interactors.push(t),this._layers.forEach(n=>{let a;n instanceof Ue?a=n:a=n.layer,this._layerInteractors.has(a)||this._layerInteractors.set(a,[]);let i=xe.initialize(t._baseName,t._userOptions);this._layerInteractors.get(a).push(i),i.setActions(i.getActions().map(s=>({...s,sideEffect:async o=>{if(s.sideEffect&&s.sideEffect(o),this._on[s.action])for(let c of this._on[s.action])try{c instanceof Ce?await c.execute({...o,self:this,instrument:this}):await c({...o,self:this,instrument:this})}catch(l){console.error(l)}}}))),i.getAcceptEvents().forEach(s=>{oe.has(a.getContainerGraphic())||oe.set(a.getContainerGraphic(),new Map),oe.get(a.getContainerGraphic()).has(s)||(a.getContainerGraphic().addEventListener(s,this._dispatch.bind(this,a,s)),oe.get(a.getContainerGraphic()).set(s,[])),oe.get(a.getContainerGraphic()).get(s).push([i,a,n instanceof Ue?null:n.options,this])})}),t.postUse(this)}attach(t,r){this._layers.find(n=>n instanceof Ue?n===t:n.layer===t)||(this.preAttach(t,r??null),arguments.length>=2?this._layers.push({layer:t,options:r}):this._layers.push(t),this.postUse(t))}getSharedVar(t,r){return!(t in this._sharedVar)&&r&&"defaultValue"in r&&this.setSharedVar(t,r.defaultValue,r),this._sharedVar[t]}setSharedVar(t,r,n){this._sharedVar[t]=r,this._on[`update:${t}`]&&this._on[`update:${t}`].forEach(s=>{s instanceof Ce?s.execute({self:this,layer:null,instrument:this,interactor:null}):s({self:this,layer:null,instrument:this,interactor:null})});let a=this.getSharedVar("linkProps")||Object.keys(this._sharedVar);if(this._sharedVar.linking)for(let i of a)this._linkCache[i]!==this._sharedVar[i]&&this._sharedVar.linking.setSharedVar(i,this._sharedVar[i])}watchSharedVar(t,r){this.on(`update:${t}`,r)}preAttach(t,r){this._preAttach&&this._preAttach.call(this,this,t),this._interactors.forEach(n=>{let a;n instanceof xe?a=n:a=n.interactor,this._layerInteractors.has(t)||this._layerInteractors.set(t,[]);let i=xe.initialize(a._baseName,a._userOptions);this._layerInteractors.get(t).push(i),i.setActions(i.getActions().map(s=>({...s,sideEffect:async o=>{if(s.sideEffect&&s.sideEffect(o),this._on[s.action])for(let c of this._on[s.action])try{c instanceof Ce?await c.execute({...o,self:this,instrument:this}):await c({...o,self:this,instrument:this})}catch(l){console.error(l)}}}))),i.getAcceptEvents().forEach(s=>{oe.has(t.getContainerGraphic())||oe.set(t.getContainerGraphic(),new Map),oe.get(t.getContainerGraphic()).has(s)||(t.getContainerGraphic().addEventListener(s,this._dispatch.bind(this,t,s)),oe.get(t.getContainerGraphic()).set(s,[])),oe.get(t.getContainerGraphic()).get(s).push([i,t,r,this])})})}async _dispatch(t,r,n){if(n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),Zn){let s=Ut.findIndex(o=>o.instrument===this&&o.layer===t&&o.eventType===r);s>=0&&Ut.splice(s,1),Ut.push({instrument:this,layer:t,eventType:r,event:n});return}Zn=!0;let a=oe.get(t.getContainerGraphic()).get(r).filter(([s,o])=>o._order>=0);a.sort((s,o)=>o[1]._order-s[1]._order);let i=!1;for(let[s,o,c,l]of a){if(n instanceof MouseEvent&&!(o._name?.toLowerCase().replaceAll("-","").replaceAll("_","")==="backgroundlayer"||o._name?.toLowerCase().replaceAll("-","").replaceAll("_","")==="bglayer"||c&&c.pointerEvents==="all")){if(!c||c.pointerEvents==="viewport"){let u=o;if(u._offset&&(n.offsetX<u._offset.x||n.offsetX>u._offset.x+u._width||n.offsetY<u._offset.y||n.offsetY>u._offset.y+u._height))continue}else if(o.picking({baseOn:z.Shape,type:D.Point,x:n.clientX,y:n.clientY}).length<=0)continue}try{let u=await s.dispatch(n,o)}catch(u){console.error(u);break}}if(Zn=!1,Ut.length){let s=Ut.shift();s.instrument._dispatch(s.layer,s.eventType,s.event)}}postUse(t){let r=t.getGraphic();r&&r.style&&(r.style.pointerEvents="auto"),this._postUse&&this._postUse.call(this,this,t)}isInstanceOf(t){return this._baseName===t||this._name===t}get services(){return $(this._serviceInstances.slice(0),Lt,this.useService.bind(this),()=>{throw new Error("Do not support dynamic change service yet")},this)}get transformers(){return $(this._transformers.slice(0),ge,t=>this._transformers.push(t),t=>this._transformers.splice(this._transformers.indexOf(t),1),this)}static register(t,r){Ft[t]=r}static unregister(t){return delete Ft[t],!0}static initialize(t,r){let n=Object.assign({constructor:S},Ft[t]??{},r??{},{on:G(Object.assign({},(Ft[t]??{}).on??{},r?.on??{})),sharedVar:Object.assign({},(Ft[t]??{}).sharedVar??{},r?.sharedVar??{})}),a=new n.constructor(t,n);return Xr.push(a),a}static findInstrument(t){return Xr.filter(r=>r.isInstanceOf(t))}};gl=W;hd=S.register,Ow=S.unregister,dd=S.initialize,pd=S.findInstrument});var xl=f(()=>{zr();re();Ot();Pr();S.register("HoverInstrument",{constructor:S,interactors:["MousePositionInteractor","TouchPositionInteractor"],on:{hover:[async({event:e,layer:t,instrument:r})=>{e.changedTouches&&(e=e.changedTouches[0]);let n=r.services.find("SelectionService");n.setSharedVar("x",e.clientX,{layer:t}),n.setSharedVar("y",e.clientY,{layer:t})}]},preAttach:(e,t)=>{e.services.add("SurfacePointSelectionService",{layer:t,sharedVar:{deepClone:e.getSharedVar("deepClone"),highlightColor:e.getSharedVar("highlightColor"),highlightAttrValues:e.getSharedVar("highlightAttrValues")}})}});S.register("ClickInstrument",{constructor:S,interactors:["MouseTraceInteractor","TouchTraceInteractor"],on:{dragstart:[async e=>{let{event:t,layer:r,instrument:n}=e;t.changedTouches&&(t=t.changedTouches[0]),n.setSharedVar("x",t.clientX),n.setSharedVar("y",t.clientY);let a=n.services.find("SelectionService");a.setSharedVar("x",t.clientX,{layer:r}),a.setSharedVar("y",t.clientY,{layer:r}),n.emit("clickstart",{...e,self:e.instrument})}],dragend:[async e=>{let{event:t,layer:r,instrument:n}=e;t.changedTouches&&(t=t.changedTouches[0]);let a=n.services.find("SelectionService");a.setSharedVar("x",0,{layer:r}),a.setSharedVar("y",0,{layer:r}),t.clientX===n.getSharedVar("x")&&t.clientY===n.getSharedVar("y")?(n.setSharedVar("x",0),n.setSharedVar("y",0),n.emit("click",{...e,self:e.instrument})):(n.setSharedVar("x",0),n.setSharedVar("y",0),n.emit("clickabort",{...e,self:e.instrument}))}],dragabort:[e=>{e.event.changedTouches&&(e.event=e.event.changedTouches[0]);let t=e.instrument.services.find("SelectionService");t.setSharedVar("x",0,{layer:e.layer}),t.setSharedVar("y",0,{layer:e.layer}),e.instrument.emit("clickabort",{...e,self:e.instrument})}]},preAttach:(e,t)=>{e.services.add("SurfacePointSelectionService",{layer:t,sharedVar:{deepClone:e.getSharedVar("deepClone"),highlightColor:e.getSharedVar("highlightColor"),highlightAttrValues:e.getSharedVar("highlightAttrValues")}})}});S.register("BrushInstrument",{constructor:S,interactors:["MouseTraceInteractor","TouchTraceInteractor"],on:{dragstart:[async({event:e,layer:t,instrument:r})=>{e.changedTouches&&(e=e.changedTouches[0]);let n=r.services.find("RectSelectionService");n.setSharedVar("x",e.clientX,{layer:t}),n.setSharedVar("y",e.clientY,{layer:t}),n.setSharedVar("width",1,{layer:t}),n.setSharedVar("height",1,{layer:t}),n.setSharedVar("startx",e.clientX,{layer:t}),n.setSharedVar("starty",e.clientY,{layer:t}),n.setSharedVar("currentx",e.clientX,{layer:t}),n.setSharedVar("currenty",e.clientY,{layer:t}),r.setSharedVar("startx",e.clientX),r.setSharedVar("starty",e.clientY),r.setSharedVar("startoffsetx",e.offsetX),r.setSharedVar("startoffsety",e.offsetY),r.transformers.find("TransientRectangleTransformer").setSharedVars({x:0,y:0,width:1,height:1})}],drag:[async({event:e,layer:t,instrument:r})=>{e.changedTouches&&(e=e.changedTouches[0]);let n=r.getSharedVar("startx"),a=r.getSharedVar("starty"),i=Math.min(n,e.clientX),s=Math.min(a,e.clientY),o=Math.abs(e.clientX-n),c=Math.abs(e.clientY-a),l=r.services.find("SelectionService");l.setSharedVar("x",i,{layer:t}),l.setSharedVar("y",s,{layer:t}),l.setSharedVar("width",o,{layer:t}),l.setSharedVar("height",c,{layer:t}),l.setSharedVar("currentx",e.clientX,{layer:t}),l.setSharedVar("currenty",e.clientY,{layer:t}),r.transformers.setSharedVars({x:i-t.getGraphic().getBoundingClientRect().left,y:s-t.getGraphic().getBoundingClientRect().top,width:o,height:c})},async e=>{let{event:t,layer:r,instrument:n}=e;t.changedTouches&&(t=t.changedTouches[0]);let a=n.getSharedVar("startoffsetx"),i=n.getSharedVar("startoffsety"),s=Math.min(a,t.offsetX),o=Math.min(i,t.offsetY),c=Math.abs(t.offsetX-a),l=Math.abs(t.offsetY-i),u=r._offset?.x??0,h=r._offset?.y??0,p=n.getSharedVar("scaleX"),d=n.getSharedVar("scaleY");if(p&&p.invert&&d&&d.invert){let x=[s-u,s-u+c].map(p.invert),g=[o-h,o-h+l].map(d.invert);n.setSharedVar("extent",[x,g],{layer:r}),n.services.find("SelectionService").filter([x,g])}else n.services.find("SelectionService").filter([[s-u,s-u+c],[o-h,o-h+l]]);n.emit("brush",e)}],dragabort:[async e=>{let{event:t,layer:r,instrument:n}=e;t.changedTouches&&(t=t.changedTouches[0]);let a=n.services.find("SelectionService");a.setSharedVar("x",0,{layer:r}),a.setSharedVar("y",0,{layer:r}),a.setSharedVar("width",0,{layer:r}),a.setSharedVar("height",0,{layer:r}),a.setSharedVar("currentx",t.clientX,{layer:r}),a.setSharedVar("currenty",t.clientY,{layer:r}),a.setSharedVar("endx",t.clientX,{layer:r}),a.setSharedVar("endy",t.clientY,{layer:r}),n.transformers.setSharedVars({x:0,y:0,width:0,height:0}),n.emit("brushabort",e)}]},preAttach:(e,t)=>{t.getLayerFromQueue("selectionLayer"),e.services.add("RectSelectionService",{layer:t,sharedVar:{deepClone:e.getSharedVar("deepClone"),highlightColor:e.getSharedVar("highlightColor"),highlightAttrValues:e.getSharedVar("highlightAttrValues")}}),e.transformers.add("TransientRectangleTransformer",{transient:!0,layer:t.getLayerFromQueue("transientLayer"),sharedVar:{x:0,y:0,width:0,height:0,fill:"#000",opacity:.3}})}});S.register("BrushXInstrument",{constructor:S,interactors:["MouseTraceInteractor","TouchTraceInteractor"],on:{dragstart:[async({event:e,layer:t,instrument:r})=>{e.changedTouches&&(e=e.changedTouches[0]);let n=r.services;n.setSharedVar("x",e.offsetX,{layer:t}),n.setSharedVar("width",1,{layer:t}),n.setSharedVar("startx",e.offsetX,{layer:t}),n.setSharedVar("currentx",e.offsetX,{layer:t}),r.setSharedVar("startx",e.offsetX),r.transformers.find("TransientRectangleTransformer").setSharedVars({x:0,width:1})}],drag:[async e=>{let{event:t,layer:r,instrument:n}=e;t.changedTouches&&(t=t.changedTouches[0]);let a=n.getSharedVar("startx"),i=Math.min(a,t.offsetX),s=Math.abs(t.offsetX-a),o=r._offset?.x??0,c=n.services,l=n.getSharedVar("scaleX");if(l&&l.invert){let u=[i-o,i-o+s].map(l.invert);n.setSharedVar("extent",u,{layer:r}),n.services.find("SelectionService").filter(u)}else n.services.find("SelectionService").filter([i-o,i-o+s]);c.setSharedVar("x",i,{layer:r}),c.setSharedVar("width",s,{layer:r}),c.setSharedVar("currentx",t.offsetX,{layer:r}),n.setSharedVar("currentx",t.offsetX),n.transformers.setSharedVars({x:i-o,width:s}),n.emit("brush",e)}],dragabort:[async e=>{let{event:t,layer:r,instrument:n}=e;t.changedTouches&&(t=t.changedTouches[0]);let a=n.services;a.setSharedVar("x",0,{layer:r}),a.setSharedVar("width",0,{layer:r}),a.setSharedVar("currentx",t.offsetX,{layer:r}),a.setSharedVar("endx",t.offsetX,{layer:r}),n.transformers.find("TransientRectangleTransformer").setSharedVars({x:0,width:0}),n.emit("brushabort",e)}]},preAttach:(e,t)=>{let r=e.getSharedVar("y")??0,n=e.getSharedVar("height")??t._height,a=e.services.add("RectSelectionService",{layer:t}),i=t.getGraphic().getBoundingClientRect();a.setSharedVar("y",i.y+r),a.setSharedVar("height",n),e.transformers.add("TransientRectangleTransformer",{transient:!0,layer:t.getLayerFromQueue("transientLayer"),sharedVar:{x:0,y:0,width:0,height:n,fill:"#000",opacity:.3}})}});S.register("BrushYInstrument",{constructor:S,interactors:["MouseTraceInteractor","TouchTraceInteractor"],on:{dragstart:[async({event:e,layer:t,instrument:r})=>{e.changedTouches&&(e=e.changedTouches[0]);let n=r.services.find("RectSelectionService");n.setSharedVar("y",e.clientY,{layer:t}),n.setSharedVar("height",1,{layer:t}),n.setSharedVar("starty",e.clientY,{layer:t}),n.setSharedVar("currenty",e.clientY,{layer:t}),r.setSharedVar("starty",e.clientY),r.transformers.find("TransientRectangleTransformer").setSharedVars({y:0,height:1})}],drag:[Z.initialize("drawBrushAndSelect",{continuous:!0,execute:async({event:e,layer:t,instrument:r})=>{e.changedTouches&&(e=e.changedTouches[0]);let n=r.getSharedVar("starty"),a=Math.min(n,e.clientY),i=Math.abs(e.clientY-n),s=r.services.find("SelectionService");s.setSharedVar("y",a,{layer:t}),s.setSharedVar("height",i,{layer:t}),s.setSharedVar("currenty",e.clientY,{layer:t}),await Promise.all(r.services.results)},feedback:[async({event:e,layer:t,instrument:r})=>{let n=r.getSharedVar("starty"),a=Math.min(n,e.clientY),i=Math.abs(e.clientY-n),s=(t.getGraphic().querySelector(".ig-layer-background")||t.getGraphic()).getBoundingClientRect();r.transformers.find("TransientRectangleTransformer").setSharedVars({y:a-s.top,height:i})},async({instrument:e})=>{e.transformers.find("HighlightSelection").setSharedVars({highlightAttrValues:e.getSharedVar("highlightAttrValues")||{}})}]})],dragabort:[async({event:e,layer:t,instrument:r})=>{e.changedTouches&&(e=e.changedTouches[0]);let n=r.services.find("SelectionService");n.setSharedVar("y",0,{layer:t}),n.setSharedVar("height",0,{layer:t}),n.setSharedVar("currenty",e.clientY,{layer:t}),n.setSharedVar("endy",e.clientY,{layer:t}),r.transformers.find("TransientRectangleTransformer").setSharedVars({y:0,height:0})}]},preAttach:(e,t)=>{let r=e.getSharedVar("x")??0,n=e.getSharedVar("width")??t._width,a=e.services.add("RectSelectionService",{layer:t}),i=t.getGraphic().getBoundingClientRect();a.setSharedVar("x",i.x+r),a.setSharedVar("width",n),e.transformers.add("TransientRectangleTransformer",{transient:!0,layer:t.getLayerFromQueue("transientLayer"),sharedVar:{x:0,y:0,width:n,height:0,fill:"#000",opacity:.3}}).add("HighlightSelection",{transient:!0,layer:t.getLayerFromQueue("selectionLayer"),sharedVar:{highlightAttrValues:{}}})}});S.register("HelperLineInstrument",{constructor:S,sharedVar:{orientation:["horizontal"]},interactors:["MousePositionInteractor","TouchPositionInteractor"],on:{hover:[({event:e,layer:t,instrument:r})=>{e.changedTouches&&(e=e.changedTouches[0]),r.transformers.setSharedVars({x:e.offsetX,y:e.offsetY}),r.setSharedVar("x",e.offsetX,{}),r.setSharedVar("y",e.offsetY,{})}]},preAttach:function(e,t){e.transformers.add("HelperLineTransformer",{layer:t.getLayerFromQueue("transientLayer"),sharedVar:{orientation:e.getSharedVar("orientation"),style:e.getSharedVar("style")||{},tooltip:e.getSharedVar("tooltip"),scaleX:e.getSharedVar("scaleX"),scaleY:e.getSharedVar("scaleY")}})}});S.register("DataBrushInstrument",{constructor:S,interactors:["MouseTraceInteractor","TouchTraceInteractor"],on:{dragstart:[async({event:e,layer:t,instrument:r})=>{e.changedTouches&&(e=e.changedTouches[0]);let n=r.getSharedVar("scaleX"),a=r.getSharedVar("scaleY"),i=r.services.find("Quantitative2DSelectionService"),s=we(e,t.getGraphic());r.setSharedVar("layerOffsetX",e.clientX-s[0]),r.setSharedVar("layerOffsetY",e.clientY-s[1]),r.setSharedVar("startx",e.clientX),r.setSharedVar("starty",e.clientY);let o=[s[0],s[0]+1].map(n.invert);i.setSharedVar("extentX",o);let c=[s[1],s[1]+1].map(a.invert);i.setSharedVar("extentX",c),r.transformers.find("TransientRectangleTransformer").setSharedVars({x:0,y:0,width:1,height:1})}],drag:[Z.initialize("drawBrushAndSelect",{continuous:!0,execute:async({event:e,layer:t,instrument:r})=>{e.changedTouches&&(e=e.changedTouches[0]);let n=r.getSharedVar("startx"),a=r.getSharedVar("starty"),i=r.getSharedVar("layerOffsetX"),s=r.getSharedVar("layerOffsetY"),o=r.getSharedVar("scaleX"),c=r.getSharedVar("scaleY"),l=Math.min(n,e.clientX)-i,u=Math.min(a,e.clientY)-s,h=Math.abs(e.clientX-n),p=Math.abs(e.clientY-a);r.setSharedVar("x",l),r.setSharedVar("y",u),r.setSharedVar("width",h),r.setSharedVar("height",p);let d=[l,l+h].map(o.invert),x=[u+p,u].map(c.invert),g=r.services.find("SelectionService");g.setSharedVar("extentX",d),g.setSharedVar("extentY",x),console.log(g),await Promise.all(r.services.results)},feedback:[async({event:e,layer:t,instrument:r})=>{let n=r.getSharedVar("x"),a=r.getSharedVar("y"),i=r.getSharedVar("width"),s=r.getSharedVar("height");r.transformers.find("TransientRectangleTransformer").setSharedVars({x:n,y:a,width:i,height:s})},async({instrument:e})=>{e.transformers.find("HighlightSelection").setSharedVars({highlightAttrValues:e.getSharedVar("highlightAttrValues")||{}})}]})],dragabort:[async({event:e,layer:t,instrument:r})=>{e.changedTouches&&(e=e.changedTouches[0]);let n=r.services.find("SelectionService");n.setSharedVar("x",0,{layer:t}),n.setSharedVar("width",0,{layer:t}),n.setSharedVar("currentx",e.clientX,{layer:t}),n.setSharedVar("endx",e.clientX,{layer:t}),r.transformers.find("TransientRectangleTransformer").setSharedVars({x:0,width:0})}]},preAttach:async(e,t)=>{let r=e.getSharedVar("scaleX"),n=e.getSharedVar("scaleY"),a=e.getSharedVar("attrNameX"),i=e.getSharedVar("extentX")??[0,0],s=i.map(r),o=e.getSharedVar("attrNameY"),c=e.getSharedVar("extentY")??[0,0],l=i.map(n).reverse(),u=e.services.add("Quantitative2DSelectionService",{layer:t});u.setSharedVar("attrNameX",a),u.setSharedVar("extentX",i),u.setSharedVar("attrNameY",o),u.setSharedVar("extentY",c),e.transformers.add("TransientRectangleTransformer",{transient:!0,layer:t.getLayerFromQueue("transientLayer"),sharedVar:{x:s[0],y:l[0],width:s[1]-s[0],height:l[1]-l[0],fill:"#000",opacity:.3}}).add("HighlightSelection",{transient:!0,layer:t.getLayerFromQueue("selectionLayer"),sharedVar:{highlightAttrValues:e.getSharedVar("highlightAttrValues")||{}}}),await Promise.all(e.services.results)}});S.register("DataBrushXInstrument",{constructor:S,interactors:["MouseTraceInteractor","TouchTraceInteractor"],on:{dragstart:[async({event:e,layer:t,instrument:r})=>{e.changedTouches&&(e=e.changedTouches[0]);let n=r.getSharedVar("scaleX"),a=r.services.find("QuantitativeSelectionService"),i=we(e,t.getGraphic())[0];r.setSharedVar("layerOffsetX",e.clientX-i),r.setSharedVar("startx",e.clientX),r.setSharedVar("startLayerPosX",i);let s=[i,i+1].map(n.invert);a.setSharedVar("extent",s),r.transformers.find("TransientRectangleTransformer").setSharedVars({x:i,width:1})}],drag:[Z.initialize("drawBrushAndSelect",{continuous:!0,execute:async({event:e,layer:t,instrument:r})=>{e.changedTouches&&(e=e.changedTouches[0]);let n=r.getSharedVar("startx"),a=r.getSharedVar("layerOffsetX"),i=r.getSharedVar("scaleX"),s=Math.min(n,e.clientX),o=Math.abs(e.clientX-n),c=[s-a,s-a+o].map(i.invert),l=r.services.find("QuantitativeSelectionService");r.setSharedVar("extent",c),l.setSharedVar("extent",c),await Promise.all(r.services.results)},feedback:[async({event:e,layer:t,instrument:r})=>{let n=r.getSharedVar("startLayerPosX"),a=we(e,t.getGraphic())[0];console.log(n,a);let i=Math.min(n,a),s=Math.abs(a-n);r.transformers.find("TransientRectangleTransformer").setSharedVars({x:i,width:s})},async({instrument:e})=>{e.transformers.find("HighlightSelection").setSharedVars({highlightAttrValues:e.getSharedVar("highlightAttrValues")||{}})}]})],dragabort:[async({event:e,layer:t,instrument:r})=>{e.changedTouches&&(e=e.changedTouches[0]);let n=r.services.find("SelectionService");n.setSharedVar("x",0,{layer:t}),n.setSharedVar("width",0,{layer:t}),n.setSharedVar("currentx",e.clientX,{layer:t}),n.setSharedVar("endx",e.clientX,{layer:t}),r.transformers.find("TransientRectangleTransformer").setSharedVars({x:0,width:0})}]},preAttach:(e,t)=>{let r=e.getSharedVar("scaleX"),n=e.getSharedVar("height")??t._height,a=e.getSharedVar("y")??0,i=e.getSharedVar("attrNameX"),s=e.getSharedVar("extentX")??[0,0],o=s.map(r),c=e.services.add("QuantitativeSelectionService",{layer:t});c.setSharedVar("attrName",i),c.setSharedVar("extent",s),e.transformers.add("TransientRectangleTransformer",{transient:!0,layer:t.getLayerFromQueue("transientLayer"),sharedVar:{x:o[0],y:a,width:o[1]-o[0],height:n,fill:"#000",opacity:.3}}).add("HighlightSelection",{transient:!0,layer:t.getLayerFromQueue("selectionLayer"),sharedVar:{highlightAttrValues:e.getSharedVar("highlightAttrValues")||{}}})}});S.register("DragInstrument",{constructor:S,interactors:["MouseTraceInteractor","TouchTraceInteractor"],on:{dragstart:[({layer:e,event:t,instrument:r})=>{t.changedTouches&&(t=t.changedTouches[0]),r.services.setSharedVars({x:t.clientX,y:t.clientY},{layer:e})}],drag:[({layer:e,event:t,instrument:r})=>{t.changedTouches&&(t=t.changedTouches[0]);let n=t.clientX-r.services.getSharedVar("x",{layer:e})[0],a=t.clientY-r.services.getSharedVar("y",{layer:e})[0];r.setSharedVar("offsetx",n,{layer:e}),r.setSharedVar("offsety",a,{layer:e})}],dragend:[({layer:e,event:t,instrument:r})=>{t.changedTouches&&(t=t.changedTouches[0]);let n=t.clientX-r.services.getSharedVar("x",{layer:e})[0],a=t.clientY-r.services.getSharedVar("y",{layer:e})[0];r.services.setSharedVars({x:0,y:0},{layer:e}),r.setSharedVar("offsetx",n,{layer:e}),r.setSharedVar("offsety",a,{layer:e})}],dragabort:[e=>{let{layer:t,event:r,instrument:n}=e;r.changedTouches&&(r=r.changedTouches[0]),n.services.setSharedVars({x:0,y:0,currentx:r.clientX,currenty:r.clientY,offsetx:0,offsety:0},{layer:t}),n.emit("dragconfirm",{...e,self:e.instrument})}]},preAttach:(e,t)=>{e.services.add("SurfacePointSelectionService",{layer:t,sharedVar:{deepClone:e.getSharedVar("deepClone")}})}});S.register("SpeechInstrument",{constructor:S,interactors:["SpeechControlInteractor"]});S.register("KeyboardHelperBarInstrument",{constructor:S,interactors:["KeyboardPositionInteractor"],on:{begin:[()=>console.log("begin")],left:[({event:e,layer:t,instrument:r})=>{let n=r.getSharedVar("speed")||1,i=t.getLayerFromQueue("transientLayer").getGraphic().querySelector("line"),o=Kn(i)[0]-n;i.setAttribute("transform",`translate(${o}, 0)`),r.setSharedVar("barX",o,{})}],right:[({event:e,layer:t,instrument:r})=>{let n=r.getSharedVar("speed")||1,i=t.getLayerFromQueue("transientLayer").getGraphic().querySelector("line"),o=Kn(i)[0]+n;i.setAttribute("transform",`translate(${o}, 0)`),r.setSharedVar("barX",o,{})}]},preAttach:function(e,t){t.getGraphic().setAttribute("tabindex",0),t.getGraphic().focus();let r=t._height,n=e.getSharedVar("startPos"),a=t.getLayerFromQueue("transientLayer"),i=document.createElementNS("http://www.w3.org/2000/svg","line");i.setAttribute("x1",n),i.setAttribute("y1","0"),i.setAttribute("x2",n),i.setAttribute("y2",r),i.setAttribute("stroke","black"),i.setAttribute("stroke-width","1px"),a.getGraphic().append(i)}});S.register("PanInstrument",{constructor:S,interactors:["MouseTraceInteractor","TouchTraceInteractor"],on:{dragstart:[({layer:e,event:t,instrument:r})=>{t.changedTouches&&(t=t.changedTouches[0]),r.setSharedVar("startx",t.clientX),r.setSharedVar("starty",t.clientY),r.transformers.forEach(a=>{let i=a.getSharedVar("scaleX"),s=a.getSharedVar("scaleY");i&&a.setSharedVar("$$scaleX",i.copy()),s&&a.setSharedVar("$$scaleY",s.copy())})}],drag:[async({layer:e,event:t,instrument:r,transformer:n})=>{t.changedTouches&&(t=t.changedTouches[0]);let a=r.transformers,i=r.getSharedVar("startx"),s=r.getSharedVar("starty"),o=r.getSharedVar("fixRange")??!1;a.forEach(c=>{let l=c.getSharedVar("scaleX"),u=c.getSharedVar("scaleY");if(o){if(l){let h=c.getSharedVar("$$scaleX"),x=h.range().map((g,_)=>g-t.clientX+i).map(g=>h.invert(g));l.domain(x),c.setSharedVar("scaleX",l)}if(u){let h=c.getSharedVar("$$scaleY"),x=h.range().map((g,_)=>g-t.clientY+s).map(g=>h.invert(g));u.domain(x),c.setSharedVar("scaleY",u)}}else{if(l){let p=c.getSharedVar("$$scaleX").range().map((d,x)=>d+t.clientX-i);l.range(p),c.setSharedVar("scaleX",l)}if(u){let p=c.getSharedVar("$$scaleY").range().map((d,x)=>d+t.clientY-s);u.range(p),c.setSharedVar("scaleY",u)}}})}],dragabort:[({layer:e,event:t,instrument:r,transformer:n})=>{}]}});S.register("PanXInstrument",{constructor:S,interactors:["MouseTraceInteractor","TouchTraceInteractor"],on:{dragstart:[({layer:e,event:t,instrument:r})=>{t.changedTouches&&(t=t.changedTouches[0]),r.setSharedVar("startx",t.clientX),r.transformers.forEach(a=>{let i=a.getSharedVar("scaleX");i&&a.setSharedVar("$$scaleX",i.copy())})}],drag:[async({layer:e,event:t,instrument:r,transformer:n})=>{t.changedTouches&&(t=t.changedTouches[0]);let a=r.transformers,i=r.getSharedVar("startx"),s=r.getSharedVar("fixRange")??!1;a.forEach(o=>{let c=o.getSharedVar("scaleX");if(s){if(c){let l=o.getSharedVar("$$scaleX"),p=l.range().map((d,x)=>d-t.clientX+i).map(d=>l.invert(d));c.domain(p),o.setSharedVar("scaleX",c)}}else if(c){let u=o.getSharedVar("$$scaleX").range().map((h,p)=>h+t.clientX-i);c.range(u),o.setSharedVar("scaleX",c)}})}],dragabort:[({layer:e,event:t,instrument:r,transformer:n})=>{}]}});S.register("GeometricZoomInstrument",{constructor:S,interactors:["MouseWheelInteractor"],on:{wheel:[({layer:e,instrument:t,event:r})=>{let n=e.getGraphic(),a=L(n),i=t.transformers;t.setSharedVar("currentx",r.offsetX),t.setSharedVar("currenty",r.offsetY);let s=r.deltaY;t.setSharedVar("delta",s);let o=t.getSharedVar("cumulativeDelta",{defaultValue:0});o+=s,t.setSharedVar("cumulativeDelta",o),s/=1e3;let[c,l]=we(r,n),u=t.getSharedVar("centroidX")||c,h=t.getSharedVar("centroidY")||l,p=t.getSharedVar("fixRange")??!1;i.forEach(d=>{let x=d.getSharedVar("scaleX"),g=d.getSharedVar("scaleY");if(p){if(x){let _=x.invert(u);x.domain(x.domain().map(v=>v-_).map(v=>v*Math.exp(-s)).map(v=>v+_)),i.forEach(v=>v.setSharedVar("scaleX",x))}if(g){let _=g.invert(h);g.domain(g.domain().map(v=>v-_).map(v=>v*Math.exp(-s)).map(v=>v+_)),i.forEach(v=>v.setSharedVar("scaleY",g))}}else{if(x){let _=x.range().map(v=>(v-u)*Math.exp(s)+u);x.range(_),d.setSharedVar("scaleX",x)}if(g){let _=g.range().map(v=>(v-h)*Math.exp(s)+h);g.range(_),d.setSharedVar("scaleY",g)}}})}],abort:[({layer:e,event:t,instrument:r,transformer:n})=>{}]}});S.register("SemanticZoomInstrument",{constructor:S,interactors:["MouseWheelInteractor"],sharedVar:{currentLevel:0},on:{wheel:[({layer:e,instrument:t,event:r})=>{let n=e.getGraphic(),a=L(n),i=t.transformers,s=t.getSharedVar("scaleLevels"),o=t.getSharedVar("currentLevel");if(o+=Math.sign(r.deltaY),t.setSharedVar("currentLevel",o),typeof s=="object"){let g=Object.keys(s).reduce(function(_,v){return Math.abs(parseInt(v)-o)<Math.abs(parseInt(_)-o)?v:_});i.setSharedVars(s[g])}t.setSharedVar("currentx",r.offsetX),t.setSharedVar("currenty",r.offsetY);let c=r.deltaY;t.setSharedVar("delta",c);let l=t.getSharedVar("cumulativeDelta",{defaultValue:0});l+=c,t.setSharedVar("cumulativeDelta",l),c/=1e3;let[u,h]=we(r,n),p=t.getSharedVar("centroidX")||u,d=t.getSharedVar("centroidY")||h,x=t.getSharedVar("fixRange")??!1;i.forEach(g=>{let _=g.getSharedVar("scaleX"),v=g.getSharedVar("scaleY");if(x){if(_){let E=_.invert(p);_.domain(_.domain().map(w=>w-E).map(w=>w*Math.exp(-c)).map(w=>w+E)),i.forEach(w=>w.setSharedVar("scaleX",_))}if(v){let E=v.invert(d);v.domain(v.domain().map(w=>w-E).map(w=>w*Math.exp(-c)).map(w=>w+E)),i.forEach(w=>w.setSharedVar("scaleY",v))}}else{if(_){let E=_.range().map(w=>(w-p)*Math.exp(c)+p);_.range(E),g.setSharedVar("scaleX",_)}if(v){let E=v.range().map(w=>(w-d)*Math.exp(c)+d);v.range(E),g.setSharedVar("scaleY",v)}}})}],abort:[({layer:e,event:t,instrument:r,transformer:n})=>{}]},postUse(e,t){let r=e.getSharedVar("scaleLevels"),n=e.transformers,a=e.getSharedVar("currentLevel");if(typeof r=="object"){let i=Object.keys(r).reduce(function(s,o){return Math.abs(parseInt(o)-a)<Math.abs(parseInt(s)-a)?o:s});n.setSharedVars(r[i])}}});S.register("ZoomXInstrument",{constructor:S,interactors:["MouseWheelInteractor"],on:{wheel:[({layer:e,instrument:t,event:r})=>{let n=e.getGraphic(),a=L(n),i=t.transformers;t.setSharedVar("currentx",r.offsetX);let s=r.deltaY;t.setSharedVar("delta",s);let o=t.getSharedVar("cumulativeDelta",{defaultValue:0});o+=s,t.setSharedVar("cumulativeDelta",o),s/=1e3;let[c,l]=we(r,n),u=t.getSharedVar("centroidX")||c,h=t.getSharedVar("fixRange")??!1;i.forEach(p=>{let d=p.getSharedVar("scaleX");if(h){if(d){let x=d.invert(u);d.domain(d.domain().map(g=>g-x).map(g=>g*Math.exp(-s)).map(g=>g+x)),i.forEach(g=>g.setSharedVar("scaleX",d))}}else if(d){let x=d.range().map(g=>(g-u)*Math.exp(s)+u);d.range(x),p.setSharedVar("scaleX",d)}})}],abort:[({layer:e,event:t,instrument:r,transformer:n})=>{}]}})});var Jn,ea,Fr=f(()=>{zr();zr();xl();Jn=Xr,ea=S});var ta={};Dl(ta,{createHistoryTrrack:()=>Ur,tryGetHistoryTrrackInstance:()=>yl,tryRegisterDynamicInstance:()=>md});async function Ur(){let e=null,t=null,r=!1,n={traceStructure:(a=e)=>({recordList:[...a.record.keys()],children:a.children.map(i=>n.traceStructure(i)),current:a===t}),commit:async()=>{if(r)return;let a=new Map;for(let{component:s,fields:o}of[{list:Wn,fields:["_state","_modalities"]},{list:Jn,fields:["_sharedVar"]},{list:Bn,fields:["_sharedVar"]},{list:Gn,fields:["_sharedVar"]}].flatMap(({list:c,fields:l})=>c.filter(u=>yl(u)===n).map(u=>({component:u,fields:l}))))await s.results,a.set(s,Object.fromEntries(o.map(c=>[c,G(s[c])])));let i={record:a,prev:t,next:null,children:[]};t&&t.children.push(i),t=i},async undo(){if(t&&t.prev){t.prev.next=t;let a=t.prev.record;r=!0;try{for(let[i,s]of a.entries())Object.entries(s).forEach(([o,c])=>i[o]=G(c)),"_sharedVar"in s&&await i.setSharedVar("$LIBRA_FORCE_UPDATE",void 0);t=t.prev}catch(i){console.error("Fail to undo history!",i);let s=t.record;for(let[o,c]of s.entries())Object.entries(c).forEach(([l,u])=>o[l]=G(u)),"_sharedVar"in c&&await o.setSharedVar("$LIBRA_FORCE_UPDATE",void 0)}r=!1}},async redo(){if(t&&t.children.length===1&&!t.next&&(t.next=t.children[0]),t&&t.next){let a=t.next.record;r=!0;try{for(let[i,s]of a.entries())Object.entries(s).forEach(([o,c])=>i[o]=G(c)),"_sharedVar"in s&&await i.setSharedVar("$LIBRA_FORCE_UPDATE",void 0);t=t.next}catch(i){console.error("Fail to redo history!",i);let s=t.record;for(let[o,c]of s.entries())Object.entries(c).forEach(([l,u])=>o[l]=G(u)),"_sharedVar"in c&&await o.setSharedVar("$LIBRA_FORCE_UPDATE",void 0)}r=!1}},async jump(a=[]){let i=a.reduce((s,o)=>s?.children[o],e);if(i){let s=i.record;r=!0;try{for(let[o,c]of s.entries())Object.entries(c).forEach(([l,u])=>o[l]=G(u)),"_sharedVar"in c&&await o.setSharedVar("$LIBRA_FORCE_UPDATE",void 0);t=i}catch(o){console.error("Fail to jump history!",o);let c=t.record;for(let[l,u]of c.entries())Object.entries(u).forEach(([h,p])=>l[h]=G(p)),"_sharedVar"in u&&await l.setSharedVar("$LIBRA_FORCE_UPDATE",void 0)}r=!1}else console.error(`History path [${a.join(", ")}] does not exist!`)}};return[Bn,Gn,_l,Jn,Wn].flatMap(a=>a).forEach(a=>{qt.has(a)||qt.set(a,n)}),await n.commit(),e=t,n}function yl(e){let t=qt.get(e);return t||{traceStructure(){return null},async commit(){},async undo(){},async redo(){}}}function md(e,t){let r=qt.get(e);r&&qt.set(t,r)}var qt,Gt=f(()=>{Dt();Fe();Nt();Fr();Yt();re();qt=new Map});function $(e,t,r,n,a){return new Proxy(e,{get(i,s){if(s==="find")return function(o,c){if("initialize"in t){let l=i.filter(u=>u.isInstanceOf(o));if(l.length<=0&&c){let u=t.initialize(c);r(u),l.push(u),ra(a,u)}return $(l,t,r,n,a)}else{let l=i.slice();return l.forEach(u=>{u.find(...arguments)}),$(l,t,r,n,a)}};if(s==="add")return(...o)=>{let c=i.slice();if("initialize"in t){let l=t.initialize(...o);return r(l),c.push(l),ra(a,l),$(c,t,r,n,a)}else return c.forEach(l=>{l.add(...o)}),$(c,t,r,n,a)};if(s==="remove")return o=>{if(t===Nr){let c=i.slice();return c.forEach(l=>{l.remove(o)}),$(c,t,r,n,a)}else{let c=i.slice();return c.filter(u=>u.isInstanceOf(o)).forEach(u=>{n(u),c.splice(c.indexOf(u),1)}),$(c,t,r,n,a)}};if(s in i&&s!=="join"&&s!=="filter")return i[s];if(i.length)return i[0][s]instanceof Function?function(){return $(i.map(o=>o[s].apply(o,arguments)),Nr,()=>{},()=>{},a)}:$(i.map(o=>o[s]),Nr,()=>{},()=>{},a);{let o=()=>{};return o[Symbol.iterator]=function*(){},o}}})}function Kn(e){try{return e.getAttribute("transform").split("(")[1].split(")")[0].split(",").map(r=>parseFloat(r))}catch(t){return[0,0]}}function Qn(e){return bl(e.trim()).map(na)}function jd(e){return bd.hasOwnProperty(e)}function Bt(e,t,r,n,a){let i=0,s,o=e.length;for(;t<o;++t){if(s=e[t],!i&&s===r)return t;a&&a.indexOf(s)>=0?--i:n&&n.indexOf(s)>=0&&++i}return t}function bl(e){let t=[],r=e.length,n=0,a=0;for(;a<r;)a=Bt(e,a,Sl,qr+vl,Gr+wl),t.push(e.substring(n,a).trim()),n=++a;if(t.length===0)throw"Empty event selector: "+e;return t}function na(e){return e[0]==="["?Vd(e):Td(e)}function Vd(e){let t=e.length,r=1,n,a;if(r=Bt(e,r,Gr,qr,Gr),r===t)throw"Empty between selector: "+e;if(n=bl(e.substring(1,r)),n.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(r+1).trim(),e[0]!==_d)throw"Expected '>' after between selector: "+e;let i=n.map(na);return a=na(e.slice(1).trim()),a.between?{between:i,stream:a}:(a.between=i,a)}function Td(e){let t={source:wd,type:""},r=[],n=[0,0],a=0,i=0,s=e.length,o=0,c,l;if(e[s-1]===wl){if(o=e.lastIndexOf(vl),o>=0){try{n=Ed(e.substring(o+1,s-1))}catch(u){throw"Invalid throttle specification: "+e}e=e.slice(0,o).trim(),s=e.length}else throw"Unmatched right brace: "+e;o=0}if(!s)throw e;if(e[0]===yd&&(a=++o),c=Bt(e,o,xd),c<s&&(r.push(e.substring(i,c).trim()),i=o=++c),o=Bt(e,o,qr),o===s)r.push(e.substring(i,s).trim());else if(r.push(e.substring(i,o).trim()),l=[],i=++o,i===s)throw"Unmatched left bracket: "+e;for(;o<s;){if(o=Bt(e,o,Gr),o===s)throw"Unmatched left bracket: "+e;if(l.push(e.substring(i,o).trim()),o<s-1&&e[++o]!==qr)throw"Expected left bracket: "+e;i=++o}if(!(s=r.length)||vd.test(r[s-1]))throw"Invalid event selector: "+e;return s>1?(t.type=r[1],a?t.markname=r[0].slice(1):jd(r[0])?t.marktype=r[0]:t.source=r[0]):t.type=r[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),n[0]&&(t.throttle=n[0]),n[1]&&(t.debounce=n[1]),t}function Ed(e){let t=e.split(Sl);if(!e.length||t.length>2)throw e;return t.map(function(r){let n=+r;if(n!==n)throw e;return n})}function G(e){if(e instanceof Array)return e.map(G);if(["string","number","boolean","undefined","bigint","symbol","function"].includes(typeof e))return e;if(e===null)return null;if(W in e&&e[W])return e;let t=Object.fromEntries(Object.entries(e).map(([r,n])=>[r,G(n)]));return Object.assign(Object.create(Object.getPrototypeOf(e)),t)}var W,z,D,Te,Nr,ra,gd,qr,Gr,vl,wl,xd,Sl,yd,_d,vd,wd,Sd,bd,la,re=f(()=>{W=Symbol("Libra");(function(e){e[e.Shape=0]="Shape",e[e.Data=1]="Data",e[e.Attr=2]="Attr"})(z||(z={}));(function(e){e[e.SurfacePoint=0]="SurfacePoint",e[e.Point=1]="Point",e[e.Circle=2]="Circle",e[e.Rect=3]="Rect",e[e.Polygon=4]="Polygon"})(D||(D={}));(function(e){e[e.Quantitative=0]="Quantitative",e[e.Nominal=1]="Nominal",e[e.Temporal=2]="Temporal"})(Te||(Te={}));Nr=class{};gd="view",qr="[",Gr="]",vl="{",wl="}",xd=":",Sl=",",yd="@",_d=">",vd=/[[\]{}]/,wd=gd,Sd={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},bd=Sd;la={stopTransient:!1};Promise.resolve().then(()=>(Gt(),ta)).then(e=>{ra=e.tryRegisterDynamicInstance})});var jl,Vl,aa,Br,Z,Cd,Jw,Id,Md,Pr=f(()=>{re();aa={},Br=[],Z=class{constructor(t,r){this[jl]=!0,r.preInitialize&&r.preInitialize.call(this,this),this._baseName=t,this._userOptions=r,this._name=r.name??t,this._feedback=r.feedback??[],this._undo=r.undo??null,this._redo=r.redo??null,this._execute=r.execute??null,this._preInitialize=r.preInitialize??null,this._postInitialize=r.postInitialize??null,this._preExecute=r.preExecute??null,this._postExecute=r.postExecute??null,r.postInitialize&&r.postInitialize.call(this,this)}undo(){this._undo&&this._undo.call(this)}redo(){this._redo&&this._redo.call(this)}async execute(t){try{this.preExecute(),this._execute&&await this._execute.call(this,t),this.postExecute();for(let r of this._feedback)await r.call(this,t);await Vl(this).commit()}catch(r){console.error(r)}}preExecute(){this._preExecute&&this._preExecute.call(this,this)}postExecute(){this._postExecute&&this._postExecute.call(this,this)}isInstanceOf(t){return this._baseName===t||this._name===t}static register(t,r){aa[t]=r}static unregister(t){return delete aa[t],!0}static initialize(t,r){let n=Object.assign({constructor:Z},aa[t]??{},r??{}),a=new n.constructor(t,n);return Br.push(a),a}static findCommand(t){return Br.filter(r=>r.isInstanceOf(t))}};jl=W;Cd=Z.register,Jw=Z.unregister,Id=Z.initialize,Md=Z.findCommand;Promise.resolve().then(()=>(Gt(),ta)).then(e=>{Vl=e.tryGetHistoryTrrackInstance})});var _l,Ce,Nt=f(()=>{Pr();Pr();_l=Br,Ce=Z});Nt();Fr();Yt();Yr();Dt();Gt();Fe();Nt();Fr();Yt();Yr();Dt();Gt();Fe();var fS={Command:Ce,Instrument:ea,Interactor:xe,Layer:Ue,Service:Lt,createHistoryTrrack:Ur,GraphicalTransformer:ge};export{Ce as Command,ge as GraphicalTransformer,ea as Instrument,xe as Interactor,Ue as Layer,Lt as Service,Ur as createHistoryTrrack,fS as default};
